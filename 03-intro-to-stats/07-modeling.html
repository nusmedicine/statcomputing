

<!DOCTYPE html>


<html lang="en" data-theme="light">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Linear Modeling - Simple &#8212; Statistical Computing for Health Informatics with R/Tidyverse</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "light";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-7Q3FF7BQBT"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-7Q3FF7BQBT');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '03-intro-to-stats/07-modeling';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Linear Modeling - Multiple" href="07-1-modeling.html" />
    <link rel="prev" title="Statistical Modeling" href="../00-md/overview-modeling.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="light">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../00-md/intro.html">
  
  
  
  
  
    <p class="title logo__title">Statistical Computing for Health Informatics with R/Tidyverse</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../00-md/intro.html">
                    Welcome
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Overview</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../01-intro-to-r/00-intro.html">Computational Thinking for Problem Solving</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction to R</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../00-md/intro-to-r.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01-intro-to-r/01-variables-data.html">Variables, Data Types and Structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01-intro-to-r/02-operations.html">Operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01-intro-to-r/03-decision.html">Decision making</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01-intro-to-r/04-iteration.html">Iterating</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01-intro-to-r/05-functions.html">Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01-intro-to-r/06-extending.html">Extending R</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction to Tidyverse</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../02-intro-to-tidyverse/01-overview.html">Overview of Tidyverse</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02-intro-to-tidyverse/02-reading.html">Reading and Inspecting Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02-intro-to-tidyverse/03-extracting.html">Extracting and Arranging Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02-intro-to-tidyverse/04-transforming.html">Transforming Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02-intro-to-tidyverse/05-tidying.html">Tidying data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02-intro-to-tidyverse/06-joining.html">Joining data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02-intro-to-tidyverse/07-1-plotting.html">Visualizing Data - Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02-intro-to-tidyverse/07-2-plotting.html">Visualizing Data - Plots</a></li>




<li class="toctree-l1"><a class="reference internal" href="../02-intro-to-tidyverse/07-3-plotting.html">Visualizing Data - Extensions</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction to Statistical Computing</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../00-md/intro-to-stats.html">Introduction to Statistical Computing</a></li>
<li class="toctree-l1"><a class="reference internal" href="01-descriptive.html">Descriptive statistics</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../00-md/overview-inferential.html">Inferential Statistics</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="02-inferential.html">Inferential Statistics</a></li>

<li class="toctree-l2"><a class="reference internal" href="02-1-estimation.html">Estimating Mean/Variance of a Population</a></li>
<li class="toctree-l2"><a class="reference internal" href="02-2-estimation.html">Estimating Uncertainty</a></li>
<li class="toctree-l2"><a class="reference internal" href="02-3-hypothesis.html">Hypothesis testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="02-4-effect.html">Effect size</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../00-md/overview-tests.html">Statistical Tests</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="03-1-ttest.html">Comparing measures from 2 groups (unrelated subjects)</a></li>

<li class="toctree-l2"><a class="reference internal" href="04-1-anova.html">Comparing measures from &gt;2 groups (unrelated subjects)</a></li>

<li class="toctree-l2"><a class="reference internal" href="05-1-fishers.html">Comparing counts between 2x2 categories (unrelated subjects)</a></li>
<li class="toctree-l2"><a class="reference internal" href="05-2-chisq.html">Comparing counts between &gt;2x2 categories (unrelated subjects)</a></li>

<li class="toctree-l2"><a class="reference internal" href="06-correlation.html">Correlating 2 measures</a></li>

</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../00-md/overview-modeling.html">Statistical Modeling</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Linear Modeling - Simple</a></li>

<li class="toctree-l2"><a class="reference internal" href="07-1-modeling.html">Linear Modeling - Multiple</a></li>

<li class="toctree-l2"><a class="reference internal" href="07-2-modeling.html">Linear Modeling - Categorical</a></li>

<li class="toctree-l2"><a class="reference internal" href="07-3-modeling.html">Generalized Linear Model - Categorical outcome</a></li>
<li class="toctree-l2"><a class="reference internal" href="08-1-prediction.html">Modeling for Prediction</a></li>

<li class="toctree-l2"><a class="reference internal" href="08-2-explanation.html">Modeling for Explanation</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/03-intro-to-stats/07-modeling.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Linear Modeling - Simple</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Linear Modeling - Simple</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-preparation">Data preparation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-can-we-estimate-the-linear-relationship">How can we estimate the linear relationship?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-the-lm-function-for-linear-modeling">Using the <code class="docutils literal notranslate"><span class="pre">lm</span></code> function for linear modeling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resampling-approach">1. Resampling approach</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#significance-testing-of-coefficients">Significance testing of coefficients</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-the-b-0-and-b-1-coefficients">1.1. Calculate the <span class="math notranslate nohighlight">\(b_0\)</span> and <span class="math notranslate nohighlight">\(b_1\)</span> coefficients</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#generate-a-null-distribution-by-resampling">1.2. Generate a null distribution by resampling</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#use-the-null-distribution-to-calculate-the-p-value">1.3. Use the null distribution to calculate the p-value</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#confidence-interval-by-bootstrap">Confidence interval by bootstrap</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#generate-bootstrap-samples-of-dataset">1. Generate bootstrap samples of dataset</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#use-the-bootstrap-distribution-to-calculate-the-confidence-interval">1.2. Use the bootstrap distribution to calculate the confidence interval</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analytical-approach">2. Analytical approach</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Significance testing of coefficients</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-the-test-statistic">2.1. Calculate the test statistic</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#use-the-theoretical-null-distribution-to-calculate-the-p-value">2.2. Use the theoretical null distribution to calculate the p-value</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#confidence-interval-of-coefficients">Confidence interval of coefficients</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-library-functions">Using library functions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-well-does-the-model-fit-the-data">How well does the model fit the data?</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#goodness-of-fit">1. Goodness of fit</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#diagnostic-plots">2. Diagnostic plots</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#application-statistical-table-and-plotting">Application: Statistical table and plotting</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#statistical-table">1. Statistical table</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#statistical-plot">2. Statistical plot</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#diagnostic-plot">3. Diagnostic plot</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-modeling-simple">Exercise - Modeling (Simple)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#part-1">Part 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#part-2">Part 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#part-3">Part 3</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="linear-modeling-simple">
<h1>Linear Modeling - Simple<a class="headerlink" href="#linear-modeling-simple" title="Permalink to this heading">#</a></h1>
<p>In linear modeling, we are interested in modeling a relationship between measures by defining a linear equation that fits the data</p>
<p><img alt="lm_uni.png" src="../_images/lm_uni.png" /></p>
<p>We will explore how we can</p>
<ul class="simple">
<li><p>obtain the <span class="math notranslate nohighlight">\(b_0\)</span> and <span class="math notranslate nohighlight">\(b_1\)</span> terms for the linear equation that fits the data</p></li>
<li><p>determine if the coefficients are significant</p></li>
<li><p>estimate the uncertainty in the estimates for <span class="math notranslate nohighlight">\(b_0\)</span> and <span class="math notranslate nohighlight">\(b_1\)</span></p></li>
<li><p>estimate how well the model fits the data</p></li>
<li><p>interpret diagnostic plots of the model fit</p></li>
</ul>
<hr class="docutils" />
<section id="data-preparation">
<h2>Data preparation<a class="headerlink" href="#data-preparation" title="Permalink to this heading">#</a></h2>
<p>We will use the dataset from the Framingham study, which was a long term study of cardiovascular disease about subjsects in Framingham, USA. In this dataset ~4000 subjects were followed up and clinical data and chronic heart disease outcomes were examined longitudinally over &gt; 10 years</p>
<p>Variables include:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">male</span></code> : 0 = female, 1 = male</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">age</span></code> : Age at the time of medical examination in years.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">education</span></code> : 1 = Some high school, 2 = high school/GED, 3 = some college/vocational school, 4 = college</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">currentSmoker</span></code>: Current cigarette smoking at the time of examinations</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cigsPerDay</span></code>: Number of cigarettes smoked each day</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BPmeds</span></code>: Use of Anti-hypertensive medication at exam</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prevalentStroke</span></code>: Prevalent Stroke</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prevalentHyp</span></code>: Prevalent Hypertensive</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">diabetes</span></code>: Diabetic according to criteria of first exam treated</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">totChol</span></code>: Total cholesterol (mg/dL)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sysBP</span></code>: Systolic Blood Pressure (mmHg)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">diaBP</span></code>: Diastolic blood pressure (mmHg)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BMI</span></code>: Body Mass Index, weight (kg)/height (m)^2</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">heartRate</span></code>: Heart rate (beats/minute)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">glucose</span></code>: Blood glucose level (mg/dL)</p></li>
</ul>
<p>We will build a model with <code class="docutils literal notranslate"><span class="pre">sysBP</span></code> as a response and explore its relationship with <code class="docutils literal notranslate"><span class="pre">BMI</span></code>. In this case, we will filter out cases that are on antihypertensive medication <code class="docutils literal notranslate"><span class="pre">BPMeds</span> <span class="pre">==</span> <span class="pre">0</span></code></p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span>

<span class="c1"># load data</span>
<span class="n">data</span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read_csv</span><span class="p">(</span><span class="s">&quot;https://raw.githubusercontent.com/kennethban/dataset/main/framingham.csv&quot;</span><span class="p">)</span>

<span class="c1"># rename and change data types</span>
<span class="n">data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">        </span><span class="nf">rename</span><span class="p">(</span><span class="n">sex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">male</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">        </span><span class="nf">mutate</span><span class="p">(</span><span class="n">sex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">sex</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">        </span><span class="nf">mutate</span><span class="p">(</span><span class="n">education</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">education</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">        </span><span class="nf">mutate</span><span class="p">(</span><span class="n">currentSmoker</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">currentSmoker</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">        </span><span class="nf">mutate</span><span class="p">(</span><span class="n">BPMeds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">BPMeds</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">        </span><span class="nf">mutate</span><span class="p">(</span><span class="n">prevalentStroke</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">prevalentStroke</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">        </span><span class="nf">mutate</span><span class="p">(</span><span class="n">prevalentHyp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">prevalentHyp</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">        </span><span class="nf">mutate</span><span class="p">(</span><span class="n">diabetes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">diabetes</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">        </span><span class="nf">mutate</span><span class="p">(</span><span class="n">TenYearCHD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">TenYearCHD</span><span class="p">))</span>

<span class="c1"># filter out cases with BPMeds and drop missing values</span>
<span class="n">data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">        </span><span class="nf">filter</span><span class="p">(</span><span class="n">BPMeds</span><span class="o">==</span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">        </span><span class="n">drop_na</span>

<span class="n">BMI_sysBP</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">select</span><span class="p">(</span><span class="n">BMI</span><span class="p">,</span><span class="w"> </span><span class="n">sysBP</span><span class="p">)</span>

<span class="nf">head</span><span class="p">(</span><span class="n">BMI_sysBP</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>── <span class=" -Color -Color-Bold">Attaching core tidyverse packages</span> ────────────────────
<span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">dplyr    </span> 1.1.1     <span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">readr    </span> 2.1.4
<span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">forcats  </span> 1.0.0     <span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">stringr  </span> 1.5.0
<span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">ggplot2  </span> 3.4.2     <span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">tibble   </span> 3.2.1
<span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">lubridate</span> 1.9.2     <span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">tidyr    </span> 1.3.0
<span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">purrr    </span> 1.0.1     
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>── <span class=" -Color -Color-Bold">Conflicts</span> ─────────────────── tidyverse_conflicts() ──
<span class=" -Color -Color-Red">✖</span> <span class=" -Color -Color-Blue">dplyr</span>::<span class=" -Color -Color-Green">filter()</span> masks <span class=" -Color -Color-Blue">stats</span>::filter()
<span class=" -Color -Color-Red">✖</span> <span class=" -Color -Color-Blue">dplyr</span>::<span class=" -Color -Color-Green">lag()</span>    masks <span class=" -Color -Color-Blue">stats</span>::lag()
<span class=" -Color -Color-Cyan">ℹ</span> Use the conflicted package (<span class=" -Color -Color-Blue">&lt;http://conflicted.r-lib.org/&gt;</span>) to force all conflicts to become errors
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">Rows: </span><span class=" -Color -Color-Blue">4240</span> <span class=" -Color -Color-Bold">Columns: </span><span class=" -Color -Color-Blue">16</span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">──</span> <span class=" -Color -Color-Bold">Column specification</span> <span class=" -Color -Color-Cyan">─────────────────────────────────</span>
<span class=" -Color -Color-Bold">Delimiter:</span> &quot;,&quot;
<span class=" -Color -Color-Green">dbl</span> (16): male, age, education, currentSmoker, cigsPerDay, BPMeds, prevalent...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">ℹ</span> Use `spec()` to retrieve the full column specification for this data.
<span class=" -Color -Color-Cyan">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.
</pre></div>
</div>
<div class="output text_html"><table class="dataframe">
<caption>A tibble: 6 × 2</caption>
<thead>
	<tr><th scope=col>BMI</th><th scope=col>sysBP</th></tr>
	<tr><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>26.97</td><td>106.0</td></tr>
	<tr><td>28.73</td><td>121.0</td></tr>
	<tr><td>25.34</td><td>127.5</td></tr>
	<tr><td>28.58</td><td>150.0</td></tr>
	<tr><td>23.10</td><td>130.0</td></tr>
	<tr><td>30.30</td><td>180.0</td></tr>
</tbody>
</table>
</div></div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># set plot dimensions</span>
<span class="nf">options</span><span class="p">(</span><span class="n">repr.plot.width</span><span class="o">=</span><span class="m">8</span><span class="p">,</span><span class="w"> </span><span class="n">repr.plot.height</span><span class="o">=</span><span class="m">8</span><span class="p">)</span>

<span class="n">BMI_sysBP</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">BMI</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">sysBP</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">                </span><span class="nf">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">                </span><span class="nf">theme_grey</span><span class="p">(</span><span class="n">base_size</span><span class="o">=</span><span class="m">16</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/784b9da7e6f90daff6dabeba1e9cad4aed73f4c4e1095fc0e600377b5c78b714.png" src="../_images/784b9da7e6f90daff6dabeba1e9cad4aed73f4c4e1095fc0e600377b5c78b714.png" />
</div>
</div>
<p>It appears there is a possibly a linear relationship between systolic BP and BMI</p>
</section>
<hr class="docutils" />
<section id="how-can-we-estimate-the-linear-relationship">
<h2>How can we estimate the linear relationship?<a class="headerlink" href="#how-can-we-estimate-the-linear-relationship" title="Permalink to this heading">#</a></h2>
<p>We can model the data between the 2 quantitative variables as a linear equation</p>
<div class="math notranslate nohighlight">
\[y=b_0 + b_1x\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\text{where } y &amp;= \text{outcome or response}\\
x &amp;= \text{covariate}\\
b_0 &amp;= \text{intercept}\\
b_1 &amp;= \text{slope (coefficient)}
\end{align}
\end{split}\]</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># define b0 (intercept) and b1 (slope)</span>
<span class="n">b0</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">100</span>
<span class="n">b1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">2</span>

<span class="c1"># set plot dimensions</span>
<span class="nf">options</span><span class="p">(</span><span class="n">repr.plot.width</span><span class="o">=</span><span class="m">8</span><span class="p">,</span><span class="w"> </span><span class="n">repr.plot.height</span><span class="o">=</span><span class="m">8</span><span class="p">)</span>

<span class="n">BMI_sysBP</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">BMI</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">sysBP</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">                </span><span class="nf">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">                </span><span class="nf">geom_abline</span><span class="p">(</span><span class="n">intercept</span><span class="o">=</span><span class="n">b0</span><span class="p">,</span><span class="w"> </span><span class="c1"># line defined by slope/intercept</span>
<span class="w">                            </span><span class="n">slope</span><span class="o">=</span><span class="n">b1</span><span class="p">,</span><span class="w"> </span>
<span class="w">                            </span><span class="n">color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">                            </span><span class="n">size</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">                </span><span class="nf">theme_grey</span><span class="p">(</span><span class="n">base_size</span><span class="o">=</span><span class="m">16</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning message:
“Using `size` aesthetic for lines was deprecated in
ggplot2 3.4.0.
<span class=" -Color -Color-Cyan">ℹ</span> Please use `linewidth` instead.”
</pre></div>
</div>
<img alt="../_images/28c18d8ce3049357db8f74bff18dcc2d8c3de83a0c1cbae8375cb30f9c3fff61.png" src="../_images/28c18d8ce3049357db8f74bff18dcc2d8c3de83a0c1cbae8375cb30f9c3fff61.png" />
</div>
</div>
<p>To estimate how well a line fits the data points, we can consider the sum of squared differences between the data points and the line specified by the intercept <span class="math notranslate nohighlight">\(b_0\)</span> and slope <span class="math notranslate nohighlight">\(b_1\)</span></p>
<ul class="simple">
<li><p>Specify the intercept <span class="math notranslate nohighlight">\(b_0\)</span> and slope <span class="math notranslate nohighlight">\(b_1\)</span> to get a linear equation <span class="math notranslate nohighlight">\(\hat{y}=b_0 + b_1x\)</span></p></li>
<li><p>For each <span class="math notranslate nohighlight">\(x\)</span> data point, calculate <span class="math notranslate nohighlight">\(\hat{y}\)</span> using the linear equation</p></li>
<li><p>Calculate the squared differences between <span class="math notranslate nohighlight">\(\hat{y}\)</span> and <span class="math notranslate nohighlight">\(y\)</span> from the data</p></li>
<li><p>Calculate the sum of squared differences <span class="math notranslate nohighlight">\(SS\)</span></p></li>
</ul>
<p><img alt="regression_ss.png" src="../_images/regression_ss.png" /></p>
<p>We’ll demonstrate this by first making a function <code class="docutils literal notranslate"><span class="pre">sum_squares</span></code> to calculate the sum of squared differences <span class="math notranslate nohighlight">\(SS\)</span></p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">sum_squares</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
<span class="w">    </span>
<span class="w">    </span><span class="c1"># b0 and b1 passed in as a vector (we need this requirement later)</span>
<span class="w">    </span><span class="n">b0</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">parameters</span><span class="p">[</span><span class="m">1</span><span class="p">]</span>
<span class="w">    </span><span class="n">b1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">parameters</span><span class="p">[</span><span class="m">2</span><span class="p">]</span>
<span class="w">    </span>
<span class="w">    </span><span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="w">    </span><span class="nf">rename</span><span class="p">(</span><span class="n">y</span><span class="o">=!!</span><span class="n">y</span><span class="p">,</span><span class="w">       </span><span class="c1"># y = dependent variable</span>
<span class="w">           </span><span class="n">x</span><span class="o">=!!</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">   </span><span class="c1"># x = independent variable</span>
<span class="w">    </span><span class="nf">mutate</span><span class="p">(</span><span class="n">y_predict</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">,</span>
<span class="w">           </span><span class="n">squared_diff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">y_predict</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="o">^</span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">    </span><span class="nf">summarize</span><span class="p">(</span><span class="n">sum_squared_diff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">squared_diff</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">    </span><span class="nf">pull</span><span class="p">(</span><span class="n">sum_squared_diff</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">    </span><span class="n">return</span>
<span class="w">    </span>
<span class="w">    </span><span class="p">}</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>We can specify <code class="docutils literal notranslate"><span class="pre">b0</span></code> and <code class="docutils literal notranslate"><span class="pre">b1</span></code> and calculate the sum of squared differences</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">b0</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">70</span>
<span class="n">b1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">2</span>
<span class="n">ss</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum_squares</span><span class="p">(</span><span class="n">parameters</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">b0</span><span class="p">,</span><span class="w"> </span><span class="n">b1</span><span class="p">),</span>
<span class="w">                  </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BMI_sysBP</span><span class="p">,</span><span class="w"> </span>
<span class="w">                  </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;sysBP&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">                  </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;BMI&quot;</span><span class="p">)</span>

<span class="c1"># set plot dimensions</span>
<span class="nf">options</span><span class="p">(</span><span class="n">repr.plot.width</span><span class="o">=</span><span class="m">8</span><span class="p">,</span><span class="w"> </span><span class="n">repr.plot.height</span><span class="o">=</span><span class="m">8</span><span class="p">)</span>

<span class="n">BMI_sysBP</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">BMI</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">sysBP</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">                </span><span class="nf">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">                </span><span class="nf">geom_abline</span><span class="p">(</span><span class="n">intercept</span><span class="o">=</span><span class="n">b0</span><span class="p">,</span><span class="w"> </span><span class="n">slope</span><span class="o">=</span><span class="n">b1</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">                </span><span class="nf">ggtitle</span><span class="p">(</span><span class="n">glue</span><span class="o">::</span><span class="nf">glue</span><span class="p">(</span><span class="s">&quot;b0: {b0}, b1: {b1}, SS: {ss}&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="c1"># add description</span>
<span class="w">                </span><span class="nf">theme_grey</span><span class="p">(</span><span class="n">base_size</span><span class="o">=</span><span class="m">16</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">                </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">hjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">20</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/052d5c86b5b908d16768620205ee2ee36d0666b79d6f299e47f33115af593237.png" src="../_images/052d5c86b5b908d16768620205ee2ee36d0666b79d6f299e47f33115af593237.png" />
</div>
</div>
<p>The goal of getting the best fit is to find the combination of <span class="math notranslate nohighlight">\(b_0\)</span> and <span class="math notranslate nohighlight">\(b_1\)</span> values that minimizes this sum squared of differences <span class="math notranslate nohighlight">\(SS\)</span></p>
<div class="math notranslate nohighlight">
\[ \hat{y}_{i} = b_0 + b_1 x_{i} \]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\widehat{b_0}, \widehat{b_1} &amp;=\underset{b_0, b_1}{\arg \min } \sum_{i=1}^{n}\left(y_{i}-\hat{y}_{i}\right)^{2}\\
&amp;=\underset{b_0, b_1}{\arg \min } \sum_{i=1}^{n}\left(y_{i}-b_0-b_1 x_{i}\right)^{2}
\end{align}
\end{split}\]</div>
<p>We want to minimize the sum of squares to find the best fitting line for the data points. To explore this, we can calculate the sum of squares when we vary <span class="math notranslate nohighlight">\(b_0\)</span> (intercept) and <span class="math notranslate nohighlight">\(b_1\)</span> (slope)</p>
<ul class="simple">
<li><p>To do this, we create a 2x2 grid of <span class="math notranslate nohighlight">\(b_0\)</span> and <span class="math notranslate nohighlight">\(b_1\)</span> values, then calculate the sum of squared differences for each combination</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># create a 2x2 grid of b0 and b1 values</span>
<span class="c1"># calculate the sum of squared differences for each combination</span>

<span class="n">grid</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">expand_grid</span><span class="p">(</span><span class="n">b0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">150</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="o">=</span><span class="m">5</span><span class="p">),</span><span class="w"> </span>
<span class="w">                    </span><span class="n">b1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="o">=</span><span class="m">0.1</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">        </span><span class="n">rowwise</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">        </span><span class="nf">mutate</span><span class="p">(</span><span class="n">ss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum_squares</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">b0</span><span class="p">,</span><span class="w"> </span><span class="n">b1</span><span class="p">),</span><span class="w"> </span>
<span class="w">                                </span><span class="n">data</span><span class="o">=</span><span class="n">BMI_sysBP</span><span class="p">,</span><span class="w"> </span>
<span class="w">                                </span><span class="n">x</span><span class="o">=</span><span class="s">&quot;BMI&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">                                </span><span class="n">y</span><span class="o">=</span><span class="s">&quot;sysBP&quot;</span><span class="p">))</span>

<span class="nf">head</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
<span class="nf">tail</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A rowwise_df: 6 × 3</caption>
<thead>
	<tr><th scope=col>b0</th><th scope=col>b1</th><th scope=col>ss</th></tr>
	<tr><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>0</td><td>0.0</td><td>62737626</td></tr>
	<tr><td>0</td><td>0.1</td><td>60347462</td></tr>
	<tr><td>0</td><td>0.2</td><td>58005313</td></tr>
	<tr><td>0</td><td>0.3</td><td>55711179</td></tr>
	<tr><td>0</td><td>0.4</td><td>53465060</td></tr>
	<tr><td>0</td><td>0.5</td><td>51266955</td></tr>
</tbody>
</table>
</div><div class="output text_html"><table class="dataframe">
<caption>A rowwise_df: 6 × 3</caption>
<thead>
	<tr><th scope=col>b0</th><th scope=col>b1</th><th scope=col>ss</th></tr>
	<tr><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>150</td><td>4.5</td><td>65890557</td></tr>
	<tr><td>150</td><td>4.6</td><td>68396529</td></tr>
	<tr><td>150</td><td>4.7</td><td>70950515</td></tr>
	<tr><td>150</td><td>4.8</td><td>73552517</td></tr>
	<tr><td>150</td><td>4.9</td><td>76202533</td></tr>
	<tr><td>150</td><td>5.0</td><td>78900565</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>We can visualize the sum of squared differences values in the grid for the different <span class="math notranslate nohighlight">\(b_0\)</span> and <span class="math notranslate nohighlight">\(b_1\)</span> parameters</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># set plot dimensions</span>
<span class="nf">options</span><span class="p">(</span><span class="n">repr.plot.width</span><span class="o">=</span><span class="m">8</span><span class="p">,</span><span class="w"> </span><span class="n">repr.plot.height</span><span class="o">=</span><span class="m">8</span><span class="p">)</span>

<span class="n">grid</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">b0</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">b1</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="n">ss</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">           </span><span class="nf">geom_point</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="m">15</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="m">7.5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">           </span><span class="nf">scale_color_gradient</span><span class="p">(</span><span class="n">low</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">high</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;salmon&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">           </span><span class="nf">theme_grey</span><span class="p">(</span><span class="n">base_size</span><span class="o">=</span><span class="m">16</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/c60ddcc94f3e8dcc7856d862c4609ade6a73a391022d8e3d78e1fdf8567ffcce.png" src="../_images/c60ddcc94f3e8dcc7856d862c4609ade6a73a391022d8e3d78e1fdf8567ffcce.png" />
</div>
</div>
<p>To find the <span class="math notranslate nohighlight">\(b_0\)</span> and <span class="math notranslate nohighlight">\(b_1\)</span> parameters that minimize the sum of squared differences <span class="math notranslate nohighlight">\(SS\)</span>, we can use an optimization function <code class="docutils literal notranslate"><span class="pre">optim</span></code></p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">optimal</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">optim</span><span class="p">(</span><span class="n">par</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">),</span><span class="w">     </span><span class="c1"># parameter starting point b0=0, b1=0</span>
<span class="w">                 </span><span class="n">sum_squares</span><span class="p">,</span><span class="w">      </span><span class="c1"># use sum_squares function (takes par as argument) </span>
<span class="w">                 </span><span class="n">data</span><span class="o">=</span><span class="n">BMI_sysBP</span><span class="p">,</span><span class="w"> </span>
<span class="w">                 </span><span class="n">x</span><span class="o">=</span><span class="s">&quot;BMI&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">                 </span><span class="n">y</span><span class="o">=</span><span class="s">&quot;sysBP&quot;</span><span class="p">)</span><span class="w"> </span>

<span class="n">b0</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">optimal</span><span class="o">$</span><span class="n">par</span><span class="p">[</span><span class="m">1</span><span class="p">]</span>
<span class="n">b1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">optimal</span><span class="o">$</span><span class="n">par</span><span class="p">[</span><span class="m">2</span><span class="p">]</span>

<span class="n">glue</span><span class="o">::</span><span class="nf">glue</span><span class="p">(</span><span class="s">&quot;b0: {b0}\n b1: {b1}&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">print</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>b0: 87.0964444904761
b1: 1.7200538117663
</pre></div>
</div>
</div>
</div>
<p>We can visualize the location of the optimal <span class="math notranslate nohighlight">\(b0\)</span> and <span class="math notranslate nohighlight">\(b1\)</span> parameters</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># set plot dimensions</span>
<span class="nf">options</span><span class="p">(</span><span class="n">repr.plot.width</span><span class="o">=</span><span class="m">8</span><span class="p">,</span><span class="w"> </span><span class="n">repr.plot.height</span><span class="o">=</span><span class="m">8</span><span class="p">)</span>

<span class="n">grid</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">b0</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">b1</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="n">ss</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">              </span><span class="nf">geom_point</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="m">15</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="m">7.5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">              </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;white&quot;</span><span class="p">,</span><span class="n">linetype</span><span class="o">=</span><span class="s">&quot;dashed&quot;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">              </span><span class="nf">geom_hline</span><span class="p">(</span><span class="n">yintercept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;white&quot;</span><span class="p">,</span><span class="n">linetype</span><span class="o">=</span><span class="s">&quot;dashed&quot;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">              </span><span class="nf">scale_color_gradient</span><span class="p">(</span><span class="n">low</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">high</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;salmon&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">              </span><span class="nf">ggtitle</span><span class="p">(</span><span class="n">glue</span><span class="o">::</span><span class="nf">glue</span><span class="p">(</span><span class="s">&quot;b0: {round(b0,2)}, b1: {round(b1,2)}&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">              </span><span class="nf">theme_grey</span><span class="p">(</span><span class="n">base_size</span><span class="o">=</span><span class="m">16</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">              </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">hjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">20</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/2c4a9e3dbb6e670f679befd6979f66a26535ac482238baa271a3431a33e6db1c.png" src="../_images/2c4a9e3dbb6e670f679befd6979f66a26535ac482238baa271a3431a33e6db1c.png" />
</div>
</div>
<p>We can plot the line using the optimal <span class="math notranslate nohighlight">\(b_0\)</span> and <span class="math notranslate nohighlight">\(b_1\)</span> parameters that minimize the sum of squared differences <span class="math notranslate nohighlight">\(SS\)</span></p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># set plot dimensions</span>
<span class="nf">options</span><span class="p">(</span><span class="n">repr.plot.width</span><span class="o">=</span><span class="m">8</span><span class="p">,</span><span class="w"> </span><span class="n">repr.plot.height</span><span class="o">=</span><span class="m">8</span><span class="p">)</span>

<span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">BMI</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">sysBP</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">           </span><span class="nf">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">           </span><span class="nf">geom_abline</span><span class="p">(</span><span class="n">intercept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b0</span><span class="p">,</span><span class="w"> </span><span class="n">slope</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b1</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">           </span><span class="nf">ggtitle</span><span class="p">(</span><span class="n">glue</span><span class="o">::</span><span class="nf">glue</span><span class="p">(</span><span class="s">&quot;Minimum SS = b0: {round(b0,1)}, b1: {round(b1,1)}&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">           </span><span class="nf">theme_grey</span><span class="p">(</span><span class="n">base_size</span><span class="o">=</span><span class="m">16</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">           </span><span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">hjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">20</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/49ceeb6111d59125abace1fb98e0030ab9d285c1b5586ec9007c67d98a6e1d26.png" src="../_images/49ceeb6111d59125abace1fb98e0030ab9d285c1b5586ec9007c67d98a6e1d26.png" />
</div>
</div>
</section>
<section id="using-the-lm-function-for-linear-modeling">
<h2>Using the <code class="docutils literal notranslate"><span class="pre">lm</span></code> function for linear modeling<a class="headerlink" href="#using-the-lm-function-for-linear-modeling" title="Permalink to this heading">#</a></h2>
<p>For linear regression modeling, we will use the <code class="docutils literal notranslate"><span class="pre">lm</span></code> function</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">lm(response</span> <span class="pre">~</span> <span class="pre">explanatory</span> <span class="pre">variable(s),</span> <span class="pre">data)</span></code></p></li>
</ul>
<p>Note that the following nomenclature are often used interchangeably</p>
<ul class="simple">
<li><p>The response is also known as the dependent variable</p></li>
<li><p>The explanatory variable is also known as the independent variable or covariate</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># build model</span>
<span class="n">fit_BMI</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">sysBP</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">BMI</span><span class="p">,</span><span class="w"> </span><span class="n">BMI_sysBP</span><span class="p">)</span><span class="w"> </span><span class="c1"># build model</span>

<span class="c1"># show coefficients</span>
<span class="n">broom</span><span class="o">::</span><span class="nf">tidy</span><span class="p">(</span><span class="n">fit_BMI</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">select</span><span class="p">(</span><span class="n">term</span><span class="p">,</span><span class="w"> </span><span class="n">estimate</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A tibble: 2 × 2</caption>
<thead>
	<tr><th scope=col>term</th><th scope=col>estimate</th></tr>
	<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>(Intercept)</td><td>87.068295</td></tr>
	<tr><td>BMI        </td><td> 1.721042</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>From the <span class="math notranslate nohighlight">\(b_0\)</span> intercept  and <span class="math notranslate nohighlight">\(b_1\)</span> slope terms, we have the linear equation relating systolic BP and BMI from the data</p>
<div class="math notranslate nohighlight">
\[y = b_0 + b_1 x\]</div>
<div class="math notranslate nohighlight">
\[\text{sysBP} = 87.07_\text{intercept} + 1.72_\text{BMI} \times \text{BMI}\]</div>
<p>Although we have obtained the coefficients for the model, we do not know</p>
<ul class="simple">
<li><p>if the estimates could have arisen by random chance</p></li>
<li><p>the range of uncertainty of the estimates</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="resampling-approach">
<h2>1. Resampling approach<a class="headerlink" href="#resampling-approach" title="Permalink to this heading">#</a></h2>
<section id="significance-testing-of-coefficients">
<h3>Significance testing of coefficients<a class="headerlink" href="#significance-testing-of-coefficients" title="Permalink to this heading">#</a></h3>
<p>To get an intuition of the null hypothesis test, we will use the resampling approach</p>
<ul class="simple">
<li><p>To do this, we randomly mix the values in the data and do this multiple times to generate a <em>dataset that represents the null hypothesis</em></p></li>
<li><p>We then calculate the coefficients <span class="math notranslate nohighlight">\(b_0\)</span> and <span class="math notranslate nohighlight">\(b_1\)</span> from the permuted data to generate the null distribution of coefficients</p></li>
<li><p>Finally, we calculate the <em>p-value</em>, which is the probability we  find coefficients <span class="math notranslate nohighlight">\(b_0\)</span> and <span class="math notranslate nohighlight">\(b_1\)</span> in the null distribution that is equal/greater than the  observed coefficient values</p></li>
</ul>
<section id="calculate-the-b-0-and-b-1-coefficients">
<h4>1.1. Calculate the <span class="math notranslate nohighlight">\(b_0\)</span> and <span class="math notranslate nohighlight">\(b_1\)</span> coefficients<a class="headerlink" href="#calculate-the-b-0-and-b-1-coefficients" title="Permalink to this heading">#</a></h4>
<p>We obtain the coefficients using the <code class="docutils literal notranslate"><span class="pre">lm</span></code> function</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">fit_BMI</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">sysBP</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">BMI</span><span class="p">,</span><span class="w"> </span><span class="n">BMI_sysBP</span><span class="p">)</span><span class="w"> </span><span class="c1"># buiild model</span>

<span class="n">obs_b0</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">fit_BMI</span><span class="o">$</span><span class="n">coefficients</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w">  </span><span class="c1"># 1st = intercept </span>
<span class="n">obs_b1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">fit_BMI</span><span class="o">$</span><span class="n">coefficients</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="w">  </span><span class="c1"># 2nd = slope</span>

<span class="n">obs_b0</span>
<span class="n">obs_b1</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><strong>(Intercept):</strong> 87.0682950430588</div><div class="output text_html"><strong>BMI:</strong> 1.72104161497274</div></div>
</div>
</section>
<section id="generate-a-null-distribution-by-resampling">
<h4>1.2. Generate a null distribution by resampling<a class="headerlink" href="#generate-a-null-distribution-by-resampling" title="Permalink to this heading">#</a></h4>
<p>First, we will generate 1000 samples from the data by randomly permuting the <code class="docutils literal notranslate"><span class="pre">sysBP</span></code> and <code class="docutils literal notranslate"><span class="pre">BMI</span></code> values independently using the <code class="docutils literal notranslate"><span class="pre">infer</span></code> library</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">infer</span><span class="p">)</span>

<span class="n">num_resample</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1000</span>

<span class="n">permute</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">  </span>
<span class="w">           </span><span class="nf">specify</span><span class="p">(</span><span class="n">sysBP</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">BMI</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">           </span><span class="nf">hypothesize</span><span class="p">(</span><span class="n">null</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;independence&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="w">           </span><span class="nf">generate</span><span class="p">(</span><span class="n">reps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">num_resample</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;permute&quot;</span><span class="p">)</span>

<span class="nf">head</span><span class="p">(</span><span class="n">permute</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A grouped_df: 6 × 3</caption>
<thead>
	<tr><th scope=col>sysBP</th><th scope=col>BMI</th><th scope=col>replicate</th></tr>
	<tr><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;int&gt;</th></tr>
</thead>
<tbody>
	<tr><td>110</td><td>26.97</td><td>1</td></tr>
	<tr><td>144</td><td>28.73</td><td>1</td></tr>
	<tr><td>120</td><td>25.34</td><td>1</td></tr>
	<tr><td>125</td><td>28.58</td><td>1</td></tr>
	<tr><td>124</td><td>23.10</td><td>1</td></tr>
	<tr><td>128</td><td>30.30</td><td>1</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>We can plot a sample of the randomly permuted dataset and include a linear regression line using the <code class="docutils literal notranslate"><span class="pre">geom_smooth</span></code> function and specifying <code class="docutils literal notranslate"><span class="pre">method=&quot;lm&quot;</span></code> to illustrate the intercept and slope estimates</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># set plot dimensions</span>
<span class="nf">options</span><span class="p">(</span><span class="n">repr.plot.width</span><span class="o">=</span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="n">repr.plot.height</span><span class="o">=</span><span class="m">10</span><span class="p">)</span>

<span class="n">permute</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">filter</span><span class="p">(</span><span class="n">replicate</span><span class="o">&lt;=</span><span class="m">9</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">            </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">sysBP</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">BMI</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">              </span><span class="nf">geom_point</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="m">0.1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">              </span><span class="nf">geom_smooth</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s">&quot;lm&quot;</span><span class="p">,</span><span class="n">se</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">              </span><span class="nf">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="n">replicate</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">              </span><span class="nf">theme_grey</span><span class="p">(</span><span class="n">base_size</span><span class="o">=</span><span class="m">16</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`geom_smooth()` using formula = &#39;y ~ x&#39;
</pre></div>
</div>
<img alt="../_images/62b3ec670f6c7cc71af15135e06e41b691806a396d226235bb1e4acdeb6f519a.png" src="../_images/62b3ec670f6c7cc71af15135e06e41b691806a396d226235bb1e4acdeb6f519a.png" />
</div>
</div>
<p>We calculate the <span class="math notranslate nohighlight">\(b_0\)</span> and <span class="math notranslate nohighlight">\(b_1\)</span> coefficients for each replicate by using the <code class="docutils literal notranslate"><span class="pre">lm</span></code> function</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">resample</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">permute</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="w">            </span><span class="nf">group_by</span><span class="p">(</span><span class="n">replicate</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">            </span><span class="nf">summarize</span><span class="p">(</span><span class="n">b0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">sysBP</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">BMI</span><span class="p">)</span><span class="o">$</span><span class="n">coefficients</span><span class="p">[</span><span class="m">1</span><span class="p">],</span>
<span class="w">                      </span><span class="n">b1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">sysBP</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">BMI</span><span class="p">)</span><span class="o">$</span><span class="n">coefficients</span><span class="p">[</span><span class="m">2</span><span class="p">])</span>

<span class="nf">head</span><span class="p">(</span><span class="n">resample</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A tibble: 6 × 3</caption>
<thead>
	<tr><th scope=col>replicate</th><th scope=col>b0</th><th scope=col>b1</th></tr>
	<tr><th scope=col>&lt;int&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>1</td><td>131.8911</td><td>-0.022573054</td></tr>
	<tr><td>2</td><td>133.4689</td><td>-0.083948354</td></tr>
	<tr><td>3</td><td>137.4435</td><td>-0.238561614</td></tr>
	<tr><td>4</td><td>128.4334</td><td> 0.111931544</td></tr>
	<tr><td>5</td><td>130.1879</td><td> 0.043682496</td></tr>
	<tr><td>6</td><td>131.1113</td><td> 0.007762255</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>We now have a distribution of both coefficients under the assumption that there is no relationship between <code class="docutils literal notranslate"><span class="pre">sysBP</span></code> and <code class="docutils literal notranslate"><span class="pre">BMI</span></code></p>
</section>
<section id="use-the-null-distribution-to-calculate-the-p-value">
<h4>1.3. Use the null distribution to calculate the p-value<a class="headerlink" href="#use-the-null-distribution-to-calculate-the-p-value" title="Permalink to this heading">#</a></h4>
<p>Now that we have the null distribution of the coefficients, we can check if any of these values exceed the observed coefficients <code class="docutils literal notranslate"><span class="pre">obs_b0</span></code> and <code class="docutils literal notranslate"><span class="pre">obs_b1</span></code></p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">resample</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">resample</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="w">            </span><span class="nf">mutate</span><span class="p">(</span><span class="n">exceed_b0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">if_else</span><span class="p">(</span><span class="nf">abs</span><span class="p">(</span><span class="n">b0</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nf">abs</span><span class="p">(</span><span class="n">obs_b0</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;Y&quot;</span><span class="p">,</span><span class="s">&quot;N&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">                            </span><span class="nf">factor</span><span class="p">(</span><span class="n">levels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Y&quot;</span><span class="p">,</span><span class="s">&quot;N&quot;</span><span class="p">)),</span>
<span class="w">                   </span><span class="n">exceed_b1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">if_else</span><span class="p">(</span><span class="nf">abs</span><span class="p">(</span><span class="n">b1</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nf">abs</span><span class="p">(</span><span class="n">obs_b1</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;Y&quot;</span><span class="p">,</span><span class="s">&quot;N&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">                            </span><span class="nf">factor</span><span class="p">(</span><span class="n">levels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Y&quot;</span><span class="p">,</span><span class="s">&quot;N&quot;</span><span class="p">)),</span>
<span class="w">                  </span><span class="p">)</span><span class="w"> </span>
<span class="w"> </span>
<span class="n">resample</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">sample_n</span><span class="p">(</span><span class="m">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A tibble: 10 × 5</caption>
<thead>
	<tr><th scope=col>replicate</th><th scope=col>b0</th><th scope=col>b1</th><th scope=col>exceed_b0</th><th scope=col>exceed_b1</th></tr>
	<tr><th scope=col>&lt;int&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th></tr>
</thead>
<tbody>
	<tr><td>940</td><td>132.9630</td><td>-0.064269444</td><td>N</td><td>N</td></tr>
	<tr><td>519</td><td>130.5342</td><td> 0.030210720</td><td>N</td><td>N</td></tr>
	<tr><td> 78</td><td>132.7899</td><td>-0.057534393</td><td>N</td><td>N</td></tr>
	<tr><td>899</td><td>132.9784</td><td>-0.064870498</td><td>N</td><td>N</td></tr>
	<tr><td>605</td><td>131.8119</td><td>-0.019491120</td><td>N</td><td>N</td></tr>
	<tr><td>394</td><td>130.7607</td><td> 0.021400574</td><td>N</td><td>N</td></tr>
	<tr><td>882</td><td>131.5186</td><td>-0.008083602</td><td>N</td><td>N</td></tr>
	<tr><td> 58</td><td>132.1259</td><td>-0.031707387</td><td>N</td><td>N</td></tr>
	<tr><td>819</td><td>132.3540</td><td>-0.040581419</td><td>N</td><td>N</td></tr>
	<tr><td>200</td><td>129.3698</td><td> 0.075508060</td><td>N</td><td>N</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>We can visualize the null distribution of <span class="math notranslate nohighlight">\(b_0\)</span> and <span class="math notranslate nohighlight">\(b_1\)</span> coefficients and indicate those values that are equal or exceed the the observed  coefficients</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># set plot dimensions</span>

<span class="nf">options</span><span class="p">(</span><span class="n">repr.plot.width</span><span class="o">=</span><span class="m">8</span><span class="p">,</span><span class="w"> </span><span class="n">repr.plot.height</span><span class="o">=</span><span class="m">8</span><span class="p">)</span>

<span class="n">resample</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">b0</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="n">exceed_b0</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">               </span><span class="nf">geom_histogram</span><span class="p">(</span><span class="n">binwidth</span><span class="o">=</span><span class="m">0.5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">               </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obs_b0</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">linetype</span><span class="o">=</span><span class="s">&quot;dashed&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">               </span><span class="nf">scale_fill_manual</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;salmon&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;grey50&quot;</span><span class="p">),</span><span class="w"> </span>
<span class="w">                                 </span><span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Y&quot;</span><span class="p">,</span><span class="s">&quot;N&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">drop</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">               </span><span class="nf">theme_grey</span><span class="p">(</span><span class="n">base_size</span><span class="o">=</span><span class="m">16</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">               </span><span class="nf">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;top&quot;</span><span class="p">)</span>

<span class="n">resample</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">b1</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="n">exceed_b1</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">               </span><span class="nf">geom_histogram</span><span class="p">(</span><span class="n">binwidth</span><span class="o">=</span><span class="m">0.01</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">               </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obs_b1</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">linetype</span><span class="o">=</span><span class="s">&quot;dashed&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">               </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">obs_b1</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">linetype</span><span class="o">=</span><span class="s">&quot;dashed&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">               </span><span class="nf">scale_fill_manual</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;salmon&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;grey50&quot;</span><span class="p">),</span><span class="w"> </span>
<span class="w">                                 </span><span class="n">labels</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Y&quot;</span><span class="p">,</span><span class="s">&quot;N&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">drop</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">               </span><span class="nf">theme_grey</span><span class="p">(</span><span class="n">base_size</span><span class="o">=</span><span class="m">16</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">               </span><span class="nf">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;top&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/b8743a3be13ba0b7ca3535945b9c5276ed4e6667228e9bb3d77018d873462448.png" src="../_images/b8743a3be13ba0b7ca3535945b9c5276ed4e6667228e9bb3d77018d873462448.png" />
<img alt="../_images/72e22064c5b8efbed8ebafd22dbf90969c3a42ad18681a0d7af63589649bfb7c.png" src="../_images/72e22064c5b8efbed8ebafd22dbf90969c3a42ad18681a0d7af63589649bfb7c.png" />
</div>
</div>
<p>Finally, we can get the <em>p-value</em> by calculating how many times the <span class="math notranslate nohighlight">\(b_0\)</span> and <span class="math notranslate nohighlight">\(b_1\)</span> coefficients in the null distribution is equal/exceeds the observed coefficients</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">resample</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">summarize</span><span class="p">(</span><span class="n">num_resample</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">n</span><span class="p">(),</span>
<span class="w">                       </span><span class="n">num_exceed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">if_else</span><span class="p">(</span><span class="n">exceed_b0</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;Y&quot;</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">sum</span><span class="p">,</span>
<span class="w">                       </span><span class="n">p_value_b0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">num_exceed</span><span class="o">/</span><span class="n">num_resample</span><span class="p">)</span>

<span class="n">resample</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">summarize</span><span class="p">(</span><span class="n">num_resample</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">n</span><span class="p">(),</span>
<span class="w">                       </span><span class="n">num_exceed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">if_else</span><span class="p">(</span><span class="n">exceed_b1</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;Y&quot;</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">sum</span><span class="p">,</span>
<span class="w">                       </span><span class="n">p_value_b1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">num_exceed</span><span class="o">/</span><span class="n">num_resample</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A tibble: 1 × 3</caption>
<thead>
	<tr><th scope=col>num_resample</th><th scope=col>num_exceed</th><th scope=col>p_value_b0</th></tr>
	<tr><th scope=col>&lt;int&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>1000</td><td>0</td><td>0</td></tr>
</tbody>
</table>
</div><div class="output text_html"><table class="dataframe">
<caption>A tibble: 1 × 3</caption>
<thead>
	<tr><th scope=col>num_resample</th><th scope=col>num_exceed</th><th scope=col>p_value_b1</th></tr>
	<tr><th scope=col>&lt;int&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>1000</td><td>0</td><td>0</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>As the p-values are small, the coefficients we obtain in the linear model are unlikely to be consistent with the null hypothesis. Thus, the coefficients in the linear model are unlikely to be due to random chance</p>
</section>
</section>
<section id="confidence-interval-by-bootstrap">
<h3>Confidence interval by bootstrap<a class="headerlink" href="#confidence-interval-by-bootstrap" title="Permalink to this heading">#</a></h3>
<p>We will use the resampling approach to obtain the confidence interval of the coefficients</p>
<ul class="simple">
<li><p>To do this, we will take bootstrap samples (sampling with replacement) from the dataset</p></li>
<li><p>We then calculate the <span class="math notranslate nohighlight">\(b_0\)</span> and <span class="math notranslate nohighlight">\(b_1\)</span> coefficients for each of the bootstrap samples to obtain a bootstrapped distribution of coefficient values</p></li>
<li><p>Finally we obtain the 95% confidence interval of the coefficients by finding the 2.5% and 97.5% percentile values from the bootstrapped distribution</p></li>
</ul>
<section id="generate-bootstrap-samples-of-dataset">
<h4>1. Generate bootstrap samples of dataset<a class="headerlink" href="#generate-bootstrap-samples-of-dataset" title="Permalink to this heading">#</a></h4>
<p>To get the confidence intervals of the coefficients, we generate bootstrap samples of the dataset (resampling with replacement) using the <code class="docutils literal notranslate"><span class="pre">infer</span></code> library</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">bootstrap</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">specify</span><span class="p">(</span><span class="n">sysBP</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">BMI</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">             </span><span class="nf">generate</span><span class="p">(</span><span class="n">reps</span><span class="o">=</span><span class="m">1000</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s">&quot;bootstrap&quot;</span><span class="p">)</span>

<span class="nf">head</span><span class="p">(</span><span class="n">bootstrap</span><span class="p">)</span>
<span class="nf">tail</span><span class="p">(</span><span class="n">bootstrap</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A grouped_df: 6 × 3</caption>
<thead>
	<tr><th scope=col>replicate</th><th scope=col>sysBP</th><th scope=col>BMI</th></tr>
	<tr><th scope=col>&lt;int&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>1</td><td>128</td><td>32.03</td></tr>
	<tr><td>1</td><td>119</td><td>26.51</td></tr>
	<tr><td>1</td><td>118</td><td>25.57</td></tr>
	<tr><td>1</td><td>136</td><td>31.02</td></tr>
	<tr><td>1</td><td>122</td><td>28.40</td></tr>
	<tr><td>1</td><td>140</td><td>21.20</td></tr>
</tbody>
</table>
</div><div class="output text_html"><table class="dataframe">
<caption>A grouped_df: 6 × 3</caption>
<thead>
	<tr><th scope=col>replicate</th><th scope=col>sysBP</th><th scope=col>BMI</th></tr>
	<tr><th scope=col>&lt;int&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>1000</td><td>163.5</td><td>28.65</td></tr>
	<tr><td>1000</td><td>158.0</td><td>35.68</td></tr>
	<tr><td>1000</td><td>157.0</td><td>33.32</td></tr>
	<tr><td>1000</td><td> 83.5</td><td>16.71</td></tr>
	<tr><td>1000</td><td>141.0</td><td>27.80</td></tr>
	<tr><td>1000</td><td>149.0</td><td>20.12</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>We calculate the <span class="math notranslate nohighlight">\(b_0\)</span> and <span class="math notranslate nohighlight">\(b_1\)</span> coefficients for each replicate in the bootstrap sample</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">boot_coef</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">bootstrap</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="w">             </span><span class="nf">group_by</span><span class="p">(</span><span class="n">replicate</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">             </span><span class="nf">summarize</span><span class="p">(</span><span class="n">b0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">sysBP</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">BMI</span><span class="p">)</span><span class="o">$</span><span class="n">coefficients</span><span class="p">[</span><span class="m">1</span><span class="p">],</span>
<span class="w">                       </span><span class="n">b1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">sysBP</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">BMI</span><span class="p">)</span><span class="o">$</span><span class="n">coefficients</span><span class="p">[</span><span class="m">2</span><span class="p">])</span>

<span class="nf">head</span><span class="p">(</span><span class="n">boot_coef</span><span class="p">)</span>
<span class="nf">tail</span><span class="p">(</span><span class="n">boot_coef</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A tibble: 6 × 3</caption>
<thead>
	<tr><th scope=col>replicate</th><th scope=col>b0</th><th scope=col>b1</th></tr>
	<tr><th scope=col>&lt;int&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>1</td><td>88.82304</td><td>1.621167</td></tr>
	<tr><td>2</td><td>92.40870</td><td>1.512129</td></tr>
	<tr><td>3</td><td>85.25969</td><td>1.767376</td></tr>
	<tr><td>4</td><td>89.82000</td><td>1.632906</td></tr>
	<tr><td>5</td><td>85.35873</td><td>1.791220</td></tr>
	<tr><td>6</td><td>87.43901</td><td>1.691797</td></tr>
</tbody>
</table>
</div><div class="output text_html"><table class="dataframe">
<caption>A tibble: 6 × 3</caption>
<thead>
	<tr><th scope=col>replicate</th><th scope=col>b0</th><th scope=col>b1</th></tr>
	<tr><th scope=col>&lt;int&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td> 995</td><td>89.61467</td><td>1.622446</td></tr>
	<tr><td> 996</td><td>88.87305</td><td>1.637064</td></tr>
	<tr><td> 997</td><td>86.08780</td><td>1.755563</td></tr>
	<tr><td> 998</td><td>86.46833</td><td>1.755667</td></tr>
	<tr><td> 999</td><td>84.66061</td><td>1.814062</td></tr>
	<tr><td>1000</td><td>86.54211</td><td>1.741173</td></tr>
</tbody>
</table>
</div></div>
</div>
</section>
<section id="use-the-bootstrap-distribution-to-calculate-the-confidence-interval">
<h4>1.2. Use the bootstrap distribution to calculate the confidence interval<a class="headerlink" href="#use-the-bootstrap-distribution-to-calculate-the-confidence-interval" title="Permalink to this heading">#</a></h4>
<p>We can use the <code class="docutils literal notranslate"><span class="pre">quantile</span></code> function to find the 2.5 and 97.5 percentile values for the lower and upper limits of the 95% confidence interval and visualize the limits on the bootstrap distribution</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the 2.5 and 97.5 percentiles for b0</span>

<span class="n">boot_b0_lower</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">quantile</span><span class="p">(</span><span class="n">boot_coef</span><span class="o">$</span><span class="n">b0</span><span class="p">,</span><span class="w"> </span><span class="m">0.025</span><span class="p">)</span>
<span class="n">boot_b0_upper</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">quantile</span><span class="p">(</span><span class="n">boot_coef</span><span class="o">$</span><span class="n">b0</span><span class="p">,</span><span class="w"> </span><span class="m">0.975</span><span class="p">)</span>

<span class="c1"># Visualize the 95% confidence interval for b0</span>

<span class="n">boot_coef</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">b0</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">              </span><span class="nf">geom_histogram</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="p">(</span><span class="n">b0</span><span class="o">&gt;=</span><span class="n">boot_b0_lower</span><span class="w"> </span><span class="o">&amp;</span>
<span class="w">                                       </span><span class="n">b0</span><span class="o">&lt;=</span><span class="n">boot_b0_upper</span><span class="p">)),</span>
<span class="w">                             </span><span class="n">binwidth</span><span class="o">=</span><span class="m">0.25</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">              </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">boot_b0_lower</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">linetype</span><span class="o">=</span><span class="s">&quot;dashed&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">              </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">boot_b0_upper</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">linetype</span><span class="o">=</span><span class="s">&quot;dashed&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">              </span><span class="nf">annotate</span><span class="p">(</span><span class="s">&quot;label&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="o">=</span><span class="w"> </span><span class="n">boot_b0_lower</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="o">=</span><span class="nf">round</span><span class="p">(</span><span class="n">boot_b0_lower</span><span class="p">,</span><span class="m">2</span><span class="p">),</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="n">label.size</span><span class="o">=</span><span class="kc">NA</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">              </span><span class="nf">annotate</span><span class="p">(</span><span class="s">&quot;label&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="o">=</span><span class="w"> </span><span class="n">boot_b0_upper</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="o">=</span><span class="nf">round</span><span class="p">(</span><span class="n">boot_b0_upper</span><span class="p">,</span><span class="m">2</span><span class="p">),</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="n">label.size</span><span class="o">=</span><span class="kc">NA</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">  </span>
<span class="w">              </span><span class="nf">theme_grey</span><span class="p">(</span><span class="n">base_size</span><span class="o">=</span><span class="m">16</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">              </span><span class="nf">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="o">=</span><span class="s">&quot;none&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/bbc3b8e874dc22dd039aee4b2678d6df8de74ced3e90ca3f54094dc030a8e1c7.png" src="../_images/bbc3b8e874dc22dd039aee4b2678d6df8de74ced3e90ca3f54094dc030a8e1c7.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">boot_b1_lower</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">quantile</span><span class="p">(</span><span class="n">boot_coef</span><span class="o">$</span><span class="n">b1</span><span class="p">,</span><span class="w"> </span><span class="m">0.025</span><span class="p">)</span>
<span class="n">boot_b1_upper</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">quantile</span><span class="p">(</span><span class="n">boot_coef</span><span class="o">$</span><span class="n">b1</span><span class="p">,</span><span class="w"> </span><span class="m">0.975</span><span class="p">)</span>

<span class="n">boot_coef</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">b1</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">              </span><span class="nf">geom_histogram</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="p">(</span><span class="n">b1</span><span class="o">&gt;=</span><span class="n">boot_b1_lower</span><span class="w"> </span><span class="o">&amp;</span>
<span class="w">                                       </span><span class="n">b1</span><span class="o">&lt;=</span><span class="n">boot_b1_upper</span><span class="p">)),</span>
<span class="w">                             </span><span class="n">binwidth</span><span class="o">=</span><span class="m">0.01</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">              </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">boot_b1_lower</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">linetype</span><span class="o">=</span><span class="s">&quot;dashed&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">              </span><span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">boot_b1_upper</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">linetype</span><span class="o">=</span><span class="s">&quot;dashed&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">              </span><span class="nf">annotate</span><span class="p">(</span><span class="s">&quot;label&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="o">=</span><span class="w"> </span><span class="n">boot_b1_lower</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="o">=</span><span class="nf">round</span><span class="p">(</span><span class="n">boot_b1_lower</span><span class="p">,</span><span class="m">2</span><span class="p">),</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="n">label.size</span><span class="o">=</span><span class="kc">NA</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">              </span><span class="nf">annotate</span><span class="p">(</span><span class="s">&quot;label&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="o">=</span><span class="w"> </span><span class="n">boot_b1_upper</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="o">=</span><span class="nf">round</span><span class="p">(</span><span class="n">boot_b1_upper</span><span class="p">,</span><span class="m">2</span><span class="p">),</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="n">label.size</span><span class="o">=</span><span class="kc">NA</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">              </span><span class="nf">theme_grey</span><span class="p">(</span><span class="n">base_size</span><span class="o">=</span><span class="m">16</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">              </span><span class="nf">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="o">=</span><span class="s">&quot;none&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/c23d9f05db270dfef607deebed546c89fa6e51f3c89bca7ebd3086b54b5b0459.png" src="../_images/c23d9f05db270dfef607deebed546c89fa6e51f3c89bca7ebd3086b54b5b0459.png" />
</div>
</div>
</section>
</section>
</section>
<hr class="docutils" />
<section id="analytical-approach">
<h2>2. Analytical approach<a class="headerlink" href="#analytical-approach" title="Permalink to this heading">#</a></h2>
<p>In the analytical approach, the null distribution and the confidence intervals are not derived from resampling but are calculated from a theoretical distribution, in this case, the t-distribution</p>
<section id="id1">
<h3>Significance testing of coefficients<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h3>
<p>We will calculate the t-statistic for the coefficients and use them to find the p-values from the null t-distribution</p>
<div class="math notranslate nohighlight">
\[t_{b_0} = \frac{b_0}{\operatorname{SE}(b_{0})}\]</div>
<div class="math notranslate nohighlight">
\[t_{b_1} = \frac{b_1}{\operatorname{SE}(b_{1})}\]</div>
<section id="calculate-the-test-statistic">
<h4>2.1. Calculate the test statistic<a class="headerlink" href="#calculate-the-test-statistic" title="Permalink to this heading">#</a></h4>
<p>Consider the error term in a linear model</p>
<div class="math notranslate nohighlight">
\[\hat{y}_{i} = b_0 + b_1 x_{i} + \varepsilon_{i}\]</div>
<p>The variance of the error term <span class="math notranslate nohighlight">\(s^2\)</span> can be estimated using the residual values, which are the differences between the actual value and the fitted value from the model</p>
<div class="math notranslate nohighlight">
\[s^{2} = \frac{1}{n-2} \sum_{i=1}^{n}\left(y_{i}-\hat{y}_{i}\right)^{2} = \frac{\mathit{SS}_\text{residuals}}{n-2}\]</div>
<p>The standard errors of the coefficients can be calculated from <span class="math notranslate nohighlight">\(s^2\)</span></p>
<div class="math notranslate nohighlight">
\[\operatorname{SE}(b_{1})=\sqrt{\frac{s^{2}}{\sum_{i=1}^{n}\left(x_{i}-\bar{x}\right)^{2}}} =
\sqrt{\frac{s^{2}}{\mathit{SS}_\text{xx}}}\]</div>
<div class="math notranslate nohighlight">
\[\operatorname{SE}(b_{0}) = \sqrt{\frac{1}{n} \frac{s^{2}\sum_{i=1}^{n} x_{i}^{2}}{\sum_{i=1}^{n}\left(x_{i}-\bar{x}\right)^{2}}}
= \operatorname{SE}(b_{1})\sqrt{\frac{\sum_{i=1}^{n} x_{i}^{2}}{n}} = \operatorname{SE}(b_{1})\sqrt{\frac{\mathit{SS}_\text{x}}{n}}
\]</div>
<p>Finally, we can calculate the t-statistic using the standard errors</p>
<div class="math notranslate nohighlight">
\[t_{b_0} = \frac{b_0}{\operatorname{SE}(b_{0})}\]</div>
<div class="math notranslate nohighlight">
\[t_{b_1} = \frac{b_1}{\operatorname{SE}(b_{1})}\]</div>
<p>We use the <code class="docutils literal notranslate"><span class="pre">lm</span></code> function to obtain the predicted values and the coefficients needed to calculate the t-statistic</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># find intercept b0 and slope b1</span>

<span class="n">fit_BMI</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">sysBP</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">BMI</span><span class="p">,</span><span class="w"> </span><span class="n">BMI_sysBP</span><span class="p">)</span><span class="w"> </span>

<span class="n">b0</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">fit_BMI</span><span class="o">$</span><span class="n">coefficients</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w">  </span><span class="c1"># 1st = intercept, 2nd = slope</span>
<span class="n">b1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">fit_BMI</span><span class="o">$</span><span class="n">coefficients</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="w">   </span>

<span class="c1"># calculate t-statistic for intercept and slope</span>

<span class="n">t_stat</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">BMI_sysBP</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="w">          </span><span class="nf">rename</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sysBP</span><span class="p">,</span><span class="w">    </span><span class="c1"># y = dependent variable                       </span>
<span class="w">                 </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BMI</span><span class="w">       </span><span class="c1"># x = independent variable</span>
<span class="w">                 </span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">                     </span>
<span class="w">          </span><span class="nf">mutate</span><span class="p">(</span><span class="n">residual</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">b0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="p">),</span><span class="w">     </span><span class="c1"># calculate residuals</span>
<span class="w">                 </span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="w">          </span><span class="nf">summarize</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="nf">n</span><span class="p">(),</span><span class="w">                         </span><span class="c1"># n</span>
<span class="w">                    </span><span class="n">mean_x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="w">              </span><span class="c1"># mean of x </span>
<span class="w">                    </span><span class="n">ss_x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="m">2</span><span class="p">),</span><span class="w">               </span><span class="c1"># sum squares of x</span>
<span class="w">                    </span><span class="n">ss_xx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="n">mean_x</span><span class="p">)</span><span class="o">^</span><span class="m">2</span><span class="p">),</span><span class="w">     </span><span class="c1"># sum square of diff x and mean of x</span>
<span class="w">                    </span><span class="n">var</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">residual</span><span class="o">^</span><span class="m">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="m">-2</span><span class="p">),</span><span class="w">   </span><span class="c1"># overall variance (df = n-2)</span>

<span class="w">                    </span><span class="n">se_b1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="n">var</span><span class="o">/</span><span class="n">ss_xx</span><span class="p">),</span><span class="w">       </span><span class="c1"># standard error b1</span>
<span class="w">                    </span><span class="n">se_b0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">se_b1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="n">ss_x</span><span class="o">/</span><span class="n">n</span><span class="p">),</span><span class="w">  </span><span class="c1"># standard error b0</span>

<span class="w">                    </span><span class="n">t_b0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b0</span><span class="o">/</span><span class="n">se_b0</span><span class="p">,</span><span class="w">               </span><span class="c1"># t-stat b0</span>
<span class="w">                    </span><span class="n">t_b1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b1</span><span class="o">/</span><span class="n">se_b1</span><span class="w">                </span><span class="c1"># t-stat b1</span>
<span class="w">                    </span><span class="p">)</span>

<span class="n">t_stat</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">select</span><span class="p">(</span><span class="n">se_b0</span><span class="p">,</span><span class="w"> </span><span class="n">se_b1</span><span class="p">,</span><span class="w"> </span><span class="n">t_b0</span><span class="p">,</span><span class="w"> </span><span class="n">t_b1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A tibble: 1 × 4</caption>
<thead>
	<tr><th scope=col>se_b0</th><th scope=col>se_b1</th><th scope=col>t_b0</th><th scope=col>t_b1</th></tr>
	<tr><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>2.178396</td><td>0.08373255</td><td>39.96899</td><td>20.55403</td></tr>
</tbody>
</table>
</div></div>
</div>
</section>
<section id="use-the-theoretical-null-distribution-to-calculate-the-p-value">
<h4>2.2. Use the theoretical null distribution to calculate the p-value<a class="headerlink" href="#use-the-theoretical-null-distribution-to-calculate-the-p-value" title="Permalink to this heading">#</a></h4>
<p>The null t distribution is parameterized by the degrees of freedom <code class="docutils literal notranslate"><span class="pre">df</span></code></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">df</span></code> = number of samples - number of parameters</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">t_stat</span><span class="o">$</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">2</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html">3545</div></div>
</div>
<p>We use the <code class="docutils literal notranslate"><span class="pre">vdist_t_prob</span></code> function from the <code class="docutils literal notranslate"><span class="pre">vistributions</span></code> library to plot the t-distribution parameterized by <code class="docutils literal notranslate"><span class="pre">df</span></code> and t-statistic for the <code class="docutils literal notranslate"><span class="pre">intercept</span></code> and <code class="docutils literal notranslate"><span class="pre">BMI</span></code></p>
<ul class="simple">
<li><p>intercept</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">vistributions</span><span class="p">)</span>

<span class="nf">vdist_t_prob</span><span class="p">(</span><span class="n">perc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t_stat</span><span class="o">$</span><span class="n">t_b0</span><span class="p">,</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s">&quot;upper&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/0f757b8fa4d4fcd8c9f34d24137816a9b9bd2c02a9c9484b2449adc1d1298ac8.png" src="../_images/0f757b8fa4d4fcd8c9f34d24137816a9b9bd2c02a9c9484b2449adc1d1298ac8.png" />
</div>
</div>
<ul class="simple">
<li><p>BMI</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">vdist_t_prob</span><span class="p">(</span><span class="n">perc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t_stat</span><span class="o">$</span><span class="n">t_b1</span><span class="p">,</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s">&quot;both&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/ae6275444131d8b4009b785ed761d7169f8f2d31b30ce74e5560c008004a7df6.png" src="../_images/ae6275444131d8b4009b785ed761d7169f8f2d31b30ce74e5560c008004a7df6.png" />
</div>
</div>
</section>
</section>
<section id="confidence-interval-of-coefficients">
<h3>Confidence interval of coefficients<a class="headerlink" href="#confidence-interval-of-coefficients" title="Permalink to this heading">#</a></h3>
<p>Recall that the 95% confidence interval is defined as</p>
<div class="math notranslate nohighlight">
\[\bar{x}-t_\mathit{lower}\times{SE} \leq \mu \leq \bar{x}+t_\mathit{upper}\times{SE}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\text{where } \mu &amp;= \text{population mean of intercept/coefficient}\\
\bar{x} &amp;= \text{sample mean of intercept/coefficient}\\
SE &amp;= \text{standard error } \frac{s}{\sqrt{n}}\\
t_\mathit{lower} &amp;= 2.5 \text{ percentile t-score}\\
t_\mathit{upper} &amp;= 97.5 \text{ percentile t-score}
\end{align}
\end{split}\]</div>
<p>The lower and upper t-scores are obtained using the <code class="docutils literal notranslate"><span class="pre">qt</span></code> function for the degree of freedom <span class="math notranslate nohighlight">\(\mathit{df}\)</span></p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">lower_t_score</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">qt</span><span class="p">(</span><span class="m">0.025</span><span class="p">,</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df</span><span class="p">)</span>
<span class="n">upper_t_score</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">qt</span><span class="p">(</span><span class="m">0.975</span><span class="p">,</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df</span><span class="p">)</span>

<span class="nf">tibble</span><span class="p">(</span><span class="n">percentile</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;0.025&quot;</span><span class="p">,</span><span class="s">&quot;0.975&quot;</span><span class="p">),</span>
<span class="w">       </span><span class="n">t_score</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="n">lower_t_score</span><span class="p">,</span><span class="n">upper_t_score</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A tibble: 2 × 2</caption>
<thead>
	<tr><th scope=col>percentile</th><th scope=col>t_score</th></tr>
	<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>0.025</td><td>-1.960633</td></tr>
	<tr><td>0.975</td><td> 1.960633</td></tr>
</tbody>
</table>
</div></div>
</div>
<p><strong>intercept</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">lower</span></code>: intercept + t_score(0.025) x std error of intercept</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">upper</span></code>: intercept + t_score(0.975) x std error of intercept</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># 95% CI for b0</span>

<span class="n">b0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">lower_t_score</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t_stat</span><span class="o">$</span><span class="n">se_b0</span>
<span class="n">b0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">upper_t_score</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t_stat</span><span class="o">$</span><span class="n">se_b0</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><strong>(Intercept):</strong> 82.7972588072809</div><div class="output text_html"><strong>(Intercept):</strong> 91.3393312788367</div></div>
</div>
<p><strong>BMI</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">lower</span></code>: BMI + t_score(0.025) x std error of BMI</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">upper</span></code>: BMI + t_score(0.975) x std error of BMI</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># 95% CI for b1</span>

<span class="n">b1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">lower_t_score</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t_stat</span><span class="o">$</span><span class="n">se_b1</span>
<span class="n">b1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">upper_t_score</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t_stat</span><span class="o">$</span><span class="n">se_b1</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><strong>BMI:</strong> 1.55687277301957</div><div class="output text_html"><strong>BMI:</strong> 1.88521045692591</div></div>
</div>
</section>
<section id="using-library-functions">
<h3>Using library functions<a class="headerlink" href="#using-library-functions" title="Permalink to this heading">#</a></h3>
<p>We can also use the <code class="docutils literal notranslate"><span class="pre">lm</span></code> function to obtain the estimates and the <em>p-values</em></p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">fit_BMI</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">sysBP</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">BMI</span><span class="p">,</span><span class="w"> </span><span class="n">BMI_sysBP</span><span class="p">)</span>

<span class="n">broom</span><span class="o">::</span><span class="nf">tidy</span><span class="p">(</span><span class="n">fit_BMI</span><span class="p">)</span><span class="w"> </span><span class="c1"># tidy summary of model</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A tibble: 2 × 5</caption>
<thead>
	<tr><th scope=col>term</th><th scope=col>estimate</th><th scope=col>std.error</th><th scope=col>statistic</th><th scope=col>p.value</th></tr>
	<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>(Intercept)</td><td>87.068295</td><td>2.17839615</td><td>39.96899</td><td>1.037545e-288</td></tr>
	<tr><td>BMI        </td><td> 1.721042</td><td>0.08373255</td><td>20.55403</td><td> 8.752219e-89</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>To get the confidence intervals of the coefficients, we use the <code class="docutils literal notranslate"><span class="pre">confint</span></code> function on the <code class="docutils literal notranslate"><span class="pre">lm</span></code> object</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">confint</span><span class="p">(</span><span class="n">fit_BMI</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A matrix: 2 × 2 of type dbl</caption>
<thead>
	<tr><th></th><th scope=col>2.5 %</th><th scope=col>97.5 %</th></tr>
</thead>
<tbody>
	<tr><th scope=row>(Intercept)</th><td>82.797259</td><td>91.33933</td></tr>
	<tr><th scope=row>BMI</th><td> 1.556873</td><td> 1.88521</td></tr>
</tbody>
</table>
</div></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="how-well-does-the-model-fit-the-data">
<h2>How well does the model fit the data?<a class="headerlink" href="#how-well-does-the-model-fit-the-data" title="Permalink to this heading">#</a></h2>
<p>We can assess how well the model fits the data by looking at</p>
<ul class="simple">
<li><p>goodness of fit measures:  <span class="math notranslate nohighlight">\(R^2\)</span> and adjusted <span class="math notranslate nohighlight">\(R^2\)</span></p></li>
<li><p>diagnostic plots of the residuals after fitting</p></li>
</ul>
<section id="goodness-of-fit">
<h3>1. Goodness of fit<a class="headerlink" href="#goodness-of-fit" title="Permalink to this heading">#</a></h3>
<p><img alt="lm_r2.png" src="../_images/lm_r2.png" /></p>
<p>We can estimate the goodness of fit to the data by considering the following</p>
<ul class="simple">
<li><p>The sum squared differences between <span class="math notranslate nohighlight">\(y\)</span> and the overall mean <span class="math notranslate nohighlight">\(\bar{y}\)</span></p></li>
</ul>
<div class="math notranslate nohighlight">
\[S S_{\mathrm{total}}=\sum_{i}\left(y_{i}-\bar{y}\right)^{2}\]</div>
<ul class="simple">
<li><p>The sum squared differences between <span class="math notranslate nohighlight">\(y\)</span> and the fitted(predicted) value <span class="math notranslate nohighlight">\(\hat{y}\)</span></p></li>
</ul>
<div class="math notranslate nohighlight">
\[S S_{\mathrm{residual}}=\sum_{i}\left(y_{i}-\hat{y}_{i}\right)^{2}\]</div>
<p>The goodness of fit <span class="math notranslate nohighlight">\(R^2\)</span> is defined as</p>
<div class="math notranslate nohighlight">
\[R^{2}=1-\frac{S S_{\mathrm{residual}}}{S S_{\mathrm{total}}}\]</div>
<p>Using these definitions, we can calculate the <span class="math notranslate nohighlight">\(SS_\text{residual}\)</span> and <span class="math notranslate nohighlight">\(SS_\text{total}\)</span> from the data to obtain <span class="math notranslate nohighlight">\(R^2\)</span></p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">data_fit</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">tibble</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="o">$</span><span class="n">sysBP</span><span class="p">,</span><span class="w"> </span>
<span class="w">                   </span><span class="n">x</span><span class="o">=</span><span class="n">data</span><span class="o">$</span><span class="n">BMI</span><span class="p">,</span>
<span class="w">                   </span><span class="n">y_mean</span><span class="o">=</span><span class="nf">mean</span><span class="p">(</span><span class="n">y</span><span class="p">),</span>
<span class="w">                   </span><span class="n">y_hat</span><span class="o">=</span><span class="n">fit_BMI</span><span class="o">$</span><span class="n">fitted.values</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">            </span><span class="nf">mutate</span><span class="p">(</span><span class="n">mean_y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">y</span><span class="p">),</span>
<span class="w">                   </span><span class="n">s_total</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">mean_y</span><span class="p">)</span><span class="o">^</span><span class="m">2</span><span class="p">,</span>
<span class="w">                   </span><span class="n">s_residual</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">y_hat</span><span class="p">)</span><span class="o">^</span><span class="m">2</span><span class="p">)</span><span class="w"> </span>


<span class="n">data_fit</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">summarize</span><span class="p">(</span><span class="n">ss_total</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">s_total</span><span class="p">),</span>
<span class="w">                       </span><span class="n">ss_residual</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">s_residual</span><span class="p">),</span>
<span class="w">                       </span><span class="n">r2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">ss_residual</span><span class="o">/</span><span class="n">ss_total</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">             </span><span class="n">head</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A tibble: 1 × 3</caption>
<thead>
	<tr><th scope=col>ss_total</th><th scope=col>ss_residual</th><th scope=col>r2</th></tr>
	<tr><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>1578362</td><td>1410293</td><td>0.1064831</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>The <span class="math notranslate nohighlight">\(R^2\)</span> can be interpreted as the amount of variance in the data explained by the model. This estimate may be <strong>biased</strong> as <em>the number of parameters (covariates) in the model increases</em></p>
<p>The unbiased estimator adjusted <span class="math notranslate nohighlight">\(R^2\)</span> accounts for the increase in parameters and is defined as</p>
<div class="math notranslate nohighlight">
\[\bar{R}^{2}=1-\frac{S S_{\text {res }} / \mathrm{df}_{e}}{S S_{\text {tot }} / \mathrm{df}_{t}}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\text{where }\mathit{df}_t &amp;= \text{number of samples} - 1 \\
\mathit{df}_e &amp;= \text{number of samples} - \text{number of parameters} - 1
\end{align}
\end{split}\]</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">num_covariates</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span>
<span class="n">num_samples</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">nrow</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="n">df_total</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">num_samples</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">1</span>
<span class="n">df_residual</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">num_samples</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">num_covariates</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">1</span>

<span class="n">data_fit</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">summarize</span><span class="p">(</span><span class="n">ss_total</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">s_total</span><span class="p">),</span>
<span class="w">                       </span><span class="n">ss_residual</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">s_residual</span><span class="p">),</span>
<span class="w">                       </span><span class="n">r2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">ss_residual</span><span class="o">/</span><span class="n">ss_total</span><span class="p">),</span>
<span class="w">                       </span><span class="n">adj_r2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">((</span><span class="n">ss_residual</span><span class="o">/</span><span class="n">df_residual</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">ss_total</span><span class="o">/</span><span class="n">df_total</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A tibble: 1 × 4</caption>
<thead>
	<tr><th scope=col>ss_total</th><th scope=col>ss_residual</th><th scope=col>r2</th><th scope=col>adj_r2</th></tr>
	<tr><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>1578362</td><td>1410293</td><td>0.1064831</td><td>0.106231</td></tr>
</tbody>
</table>
</div></div>
</div>
<p><strong>Using a function</strong></p>
<p>We can extract the <span class="math notranslate nohighlight">\(R^2\)</span> and adjusted <span class="math notranslate nohighlight">\(R^2\)</span> values from the <code class="docutils literal notranslate"><span class="pre">lm</span></code> object by using the <code class="docutils literal notranslate"><span class="pre">summary</span></code> function</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">summary</span><span class="p">(</span><span class="n">fit_BMI</span><span class="p">)</span><span class="o">$</span><span class="n">r.squared</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">fit_BMI</span><span class="p">)</span><span class="o">$</span><span class="n">adj.r.squared</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">0.10648308068169</div><div class="output text_html">0.106231030774971</div></div>
</div>
</section>
<section id="diagnostic-plots">
<h3>2. Diagnostic plots<a class="headerlink" href="#diagnostic-plots" title="Permalink to this heading">#</a></h3>
<p>We can also assess the model fit by looking at diagnostic plots using the <code class="docutils literal notranslate"><span class="pre">autoplot</span></code> function from the <code class="docutils literal notranslate"><span class="pre">ggfortify</span></code> library</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">ggfortify</span><span class="p">)</span>

<span class="c1"># set plot dimensions</span>
<span class="nf">options</span><span class="p">(</span><span class="n">repr.plot.width</span><span class="o">=</span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="n">repr.plot.height</span><span class="o">=</span><span class="m">5</span><span class="p">)</span>

<span class="n">fit_BMI</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">autoplot</span><span class="p">(</span><span class="n">which</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="c1"># show only first 2 plots</span>
<span class="w">            </span><span class="nf">theme_grey</span><span class="p">(</span><span class="n">base_size</span><span class="o">=</span><span class="m">16</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/023afa85876cffd11fdd94b9681ea00f9d4efb8daf405248ace8b53c716a63e9.png" src="../_images/023afa85876cffd11fdd94b9681ea00f9d4efb8daf405248ace8b53c716a63e9.png" />
</div>
</div>
<ol class="arabic simple">
<li><p><strong>Residuals vs Fitted</strong></p></li>
</ol>
<ul class="simple">
<li><p>Residuals hover around the 0 line indicating linear fit is appropriate</p></li>
<li><p>Residuals roughly cluster along a horizontal band indicating variances are equal</p></li>
<li><p>No significant outliers</p></li>
</ul>
<p><img alt="lm_diagnostic.png" src="../_images/lm_diagnostic.png" /></p>
<p>For details see: <a class="reference external" href="https://stats.stackexchange.com/questions/76226/interpreting-the-residuals-vs-fitted-values-plot-for-verifying-the-assumptions">https://stats.stackexchange.com/questions/76226/interpreting-the-residuals-vs-fitted-values-plot-for-verifying-the-assumptions</a></p>
<ol class="arabic simple" start="2">
<li><p><strong>QQ plot of residuals</strong></p></li>
</ol>
<ul class="simple">
<li><p>Residuals are roughly normally distributed</p></li>
</ul>
</section>
</section>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="application-statistical-table-and-plotting">
<h1>Application: Statistical table and plotting<a class="headerlink" href="#application-statistical-table-and-plotting" title="Permalink to this heading">#</a></h1>
<p>We will be using these libraries for making statistical tables  and plots for the linear models</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">stargazer</span></code>: statistical tables for models</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ggstatsplot</span></code>: plotting of the model coefficients</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ggfortify</span></code>: diagnostic plots for models</p></li>
</ul>
<p>To illustrate how we use them, we will build a simple model looking at the relationship between <code class="docutils literal notranslate"><span class="pre">sysBP</span></code> and <code class="docutils literal notranslate"><span class="pre">BMI</span></code> variables in the Framingham dataset</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span>

<span class="c1"># load data</span>
<span class="n">data</span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read_csv</span><span class="p">(</span><span class="s">&quot;https://raw.githubusercontent.com/kennethban/dataset/main/framingham.csv&quot;</span><span class="p">)</span>

<span class="c1"># rename and change data types</span>
<span class="n">data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">        </span><span class="nf">rename</span><span class="p">(</span><span class="n">sex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">male</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">        </span><span class="nf">mutate</span><span class="p">(</span><span class="n">sex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">sex</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">        </span><span class="nf">mutate</span><span class="p">(</span><span class="n">education</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">education</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">        </span><span class="nf">mutate</span><span class="p">(</span><span class="n">currentSmoker</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">currentSmoker</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">        </span><span class="nf">mutate</span><span class="p">(</span><span class="n">BPMeds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">BPMeds</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">        </span><span class="nf">mutate</span><span class="p">(</span><span class="n">prevalentStroke</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">prevalentStroke</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">        </span><span class="nf">mutate</span><span class="p">(</span><span class="n">prevalentHyp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">prevalentHyp</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">        </span><span class="nf">mutate</span><span class="p">(</span><span class="n">diabetes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">diabetes</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">        </span><span class="nf">mutate</span><span class="p">(</span><span class="n">TenYearCHD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">TenYearCHD</span><span class="p">))</span>

<span class="c1"># filter out cases with BPMeds and drop missing values</span>
<span class="n">data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">        </span><span class="nf">filter</span><span class="p">(</span><span class="n">BPMeds</span><span class="o">==</span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">        </span><span class="n">drop_na</span>

<span class="n">BMI_sysBP</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">select</span><span class="p">(</span><span class="n">BMI</span><span class="p">,</span><span class="w"> </span><span class="n">sysBP</span><span class="p">)</span>

<span class="nf">head</span><span class="p">(</span><span class="n">BMI_sysBP</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">Rows: </span><span class=" -Color -Color-Blue">4240</span> <span class=" -Color -Color-Bold">Columns: </span><span class=" -Color -Color-Blue">16</span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">──</span> <span class=" -Color -Color-Bold">Column specification</span> <span class=" -Color -Color-Cyan">─────────────────────────────────</span>
<span class=" -Color -Color-Bold">Delimiter:</span> &quot;,&quot;
<span class=" -Color -Color-Green">dbl</span> (16): male, age, education, currentSmoker, cigsPerDay, BPMeds, prevalent...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">ℹ</span> Use `spec()` to retrieve the full column specification for this data.
<span class=" -Color -Color-Cyan">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.
</pre></div>
</div>
<div class="output text_html"><table class="dataframe">
<caption>A tibble: 6 × 2</caption>
<thead>
	<tr><th scope=col>BMI</th><th scope=col>sysBP</th></tr>
	<tr><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>26.97</td><td>106.0</td></tr>
	<tr><td>28.73</td><td>121.0</td></tr>
	<tr><td>25.34</td><td>127.5</td></tr>
	<tr><td>28.58</td><td>150.0</td></tr>
	<tr><td>23.10</td><td>130.0</td></tr>
	<tr><td>30.30</td><td>180.0</td></tr>
</tbody>
</table>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># build model</span>

<span class="n">fit_BMI</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">sysBP</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">BMI</span><span class="p">,</span><span class="w"> </span><span class="n">BMI_sysBP</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="statistical-table">
<h2>1. Statistical table<a class="headerlink" href="#statistical-table" title="Permalink to this heading">#</a></h2>
<p>We will use the <code class="docutils literal notranslate"><span class="pre">stargazer</span></code> function from the <code class="docutils literal notranslate"><span class="pre">stargazer</span></code> library to generate a statistical table from the model. The function can take one or more models as its input and we can specify the following options</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ci</span></code>: set to TRUE to print the confidence intervals</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">type</span></code>: set to HTML to print the table in the notebook</p></li>
</ul>
<p>We will define a local function <code class="docutils literal notranslate"><span class="pre">print_html</span></code> to print the HTML output from <code class="docutils literal notranslate"><span class="pre">stargazer</span></code> in the notebook</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># print html convenience function</span>

<span class="n">print_html</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">input</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span>
<span class="w">    </span><span class="nf">capture.output</span><span class="p">(</span><span class="n">input</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="w">    </span><span class="nf">paste</span><span class="p">(</span><span class="n">collapse</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="w">    </span><span class="n">IRdisplay</span><span class="o">::</span><span class="nf">display_html</span><span class="p">()</span>
<span class="w">    </span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># print stargazer table</span>

<span class="nf">library</span><span class="p">(</span><span class="n">stargazer</span><span class="p">)</span>

<span class="nf">stargazer</span><span class="p">(</span><span class="n">fit_BMI</span><span class="p">,</span><span class="w"> </span><span class="n">ci</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s">&quot;html&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">print_html</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Please cite as: 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Hlavac, Marek (2022). stargazer: Well-Formatted Regression and Summary Statistics Tables.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> R package version 5.2.3. https://CRAN.R-project.org/package=stargazer 
</pre></div>
</div>
<div class="output text_html"><table style="text-align:center"><tr><td colspan="2" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left"></td><td><em>Dependent variable:</em></td></tr><tr><td></td><td colspan="1" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left"></td><td>sysBP</td></tr><tr><td colspan="2" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left">BMI</td><td>1.721<sup>***</sup></td></tr><tr><td style="text-align:left"></td><td>(1.557, 1.885)</td></tr><tr><td style="text-align:left"></td><td></td></tr><tr><td style="text-align:left">Constant</td><td>87.068<sup>***</sup></td></tr><tr><td style="text-align:left"></td><td>(82.799, 91.338)</td></tr><tr><td style="text-align:left"></td><td></td></tr><tr><td colspan="2" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left">Observations</td><td>3,547</td></tr><tr><td style="text-align:left">R<sup>2</sup></td><td>0.106</td></tr><tr><td style="text-align:left">Adjusted R<sup>2</sup></td><td>0.106</td></tr><tr><td style="text-align:left">Residual Std. Error</td><td>19.946 (df = 3545)</td></tr><tr><td style="text-align:left">F Statistic</td><td>422.468<sup>***</sup> (df = 1; 3545)</td></tr><tr><td colspan="2" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left"><em>Note:</em></td><td style="text-align:right"><sup>*</sup>p<0.1; <sup>**</sup>p<0.05; <sup>***</sup>p<0.01</td></tr></table></div></div>
</div>
</section>
<section id="statistical-plot">
<h2>2. Statistical plot<a class="headerlink" href="#statistical-plot" title="Permalink to this heading">#</a></h2>
<p>We will use the <code class="docutils literal notranslate"><span class="pre">ggcoefstats</span></code> function from <code class="docutils literal notranslate"><span class="pre">ggstatsplot</span></code> to generate a plot of the coefficients with the confidence intervals and the associated p-values. We can specify the following options</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">exclude.intercept</span></code>: set to TRUE to omit the intercept</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">stats.label.args</span></code>: provide a list of options for the labels if desired</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">ggstatsplot</span><span class="p">)</span>

<span class="c1"># set plot dimensions</span>
<span class="nf">options</span><span class="p">(</span><span class="n">repr.plot.width</span><span class="o">=</span><span class="m">8</span><span class="p">,</span><span class="w"> </span><span class="n">repr.plot.height</span><span class="o">=</span><span class="m">8</span><span class="p">)</span>

<span class="n">fit_BMI</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">ggcoefstats</span><span class="p">(</span><span class="n">exclude.intercept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">,</span>
<span class="w">                         </span><span class="n">stats.label.args</span><span class="o">=</span><span class="nf">list</span><span class="p">(</span><span class="n">nudge_y</span><span class="o">=</span><span class="m">0.1</span><span class="p">,</span><span class="w"> </span>
<span class="w">                                               </span><span class="n">size</span><span class="o">=</span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="n">label.size</span><span class="o">=</span><span class="kc">NA</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">                          </span><span class="nf">theme_grey</span><span class="p">(</span><span class="n">base_size</span><span class="o">=</span><span class="m">16</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>You can cite this package as:
     Patil, I. (2021). Visualizations with statistical details: The &#39;ggstatsplot&#39; approach.
     Journal of Open Source Software, 6(61), 3167, doi:10.21105/joss.03167
</pre></div>
</div>
<img alt="../_images/86ab5ce8815c7a286596b88cada1c03ff4f9f54d392253a609ea34e25dbdc1d5.png" src="../_images/86ab5ce8815c7a286596b88cada1c03ff4f9f54d392253a609ea34e25dbdc1d5.png" />
</div>
</div>
</section>
<section id="diagnostic-plot">
<h2>3. Diagnostic plot<a class="headerlink" href="#diagnostic-plot" title="Permalink to this heading">#</a></h2>
<p>We will use the <code class="docutils literal notranslate"><span class="pre">autoplot</span></code> function from the <code class="docutils literal notranslate"><span class="pre">ggfortify</span></code> library to generate basic diagnostic plots of the residuals. For simplicity, we specify the option <code class="docutils literal notranslate"><span class="pre">which</span> <span class="pre">=</span> <span class="pre">1:2</span></code> to limit the plots to</p>
<ul class="simple">
<li><p>Residuals vs Fitted</p></li>
<li><p>Normal Q-Q</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">ggfortify</span><span class="p">)</span>

<span class="c1"># set plot dimensions</span>
<span class="nf">options</span><span class="p">(</span><span class="n">repr.plot.width</span><span class="o">=</span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="n">repr.plot.height</span><span class="o">=</span><span class="m">5</span><span class="p">)</span>

<span class="n">fit_BMI</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">autoplot</span><span class="p">(</span><span class="n">which</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">            </span><span class="nf">theme_grey</span><span class="p">(</span><span class="n">base_size</span><span class="o">=</span><span class="m">16</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/023afa85876cffd11fdd94b9681ea00f9d4efb8daf405248ace8b53c716a63e9.png" src="../_images/023afa85876cffd11fdd94b9681ea00f9d4efb8daf405248ace8b53c716a63e9.png" />
</div>
</div>
</section>
<hr class="docutils" />
<section id="exercise-modeling-simple">
<h2>Exercise - Modeling (Simple)<a class="headerlink" href="#exercise-modeling-simple" title="Permalink to this heading">#</a></h2>
<p>For this exercise, we will use the Framingham dataset and model the relationship between <code class="docutils literal notranslate"><span class="pre">totChol</span></code> and <code class="docutils literal notranslate"><span class="pre">BMI</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span>

<span class="c1"># load data</span>
<span class="n">data</span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read_csv</span><span class="p">(</span><span class="s">&quot;https://raw.githubusercontent.com/kennethban/dataset/main/framingham.csv&quot;</span><span class="p">)</span>

<span class="c1"># rename and change data types</span>
<span class="n">data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">        </span><span class="nf">rename</span><span class="p">(</span><span class="n">sex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">male</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">        </span><span class="nf">mutate</span><span class="p">(</span><span class="n">sex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">sex</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">        </span><span class="nf">mutate</span><span class="p">(</span><span class="n">education</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">education</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">        </span><span class="nf">mutate</span><span class="p">(</span><span class="n">currentSmoker</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">currentSmoker</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">        </span><span class="nf">mutate</span><span class="p">(</span><span class="n">BPMeds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">BPMeds</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">        </span><span class="nf">mutate</span><span class="p">(</span><span class="n">prevalentStroke</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">prevalentStroke</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">        </span><span class="nf">mutate</span><span class="p">(</span><span class="n">prevalentHyp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">prevalentHyp</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">        </span><span class="nf">mutate</span><span class="p">(</span><span class="n">diabetes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">diabetes</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">        </span><span class="nf">mutate</span><span class="p">(</span><span class="n">TenYearCHD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">TenYearCHD</span><span class="p">))</span>

<span class="c1"># filter out cases with BPMeds and drop missing values</span>
<span class="n">data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">        </span><span class="nf">filter</span><span class="p">(</span><span class="n">BPMeds</span><span class="o">==</span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">        </span><span class="n">drop_na</span>

<span class="n">BMI_totChol</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">select</span><span class="p">(</span><span class="n">BMI</span><span class="p">,</span><span class="w"> </span><span class="n">totChol</span><span class="p">)</span>

<span class="nf">head</span><span class="p">(</span><span class="n">BMI_totChol</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">Rows: </span><span class=" -Color -Color-Blue">4240</span> <span class=" -Color -Color-Bold">Columns: </span><span class=" -Color -Color-Blue">16</span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">──</span> <span class=" -Color -Color-Bold">Column specification</span> <span class=" -Color -Color-Cyan">─────────────────────────────────</span>
<span class=" -Color -Color-Bold">Delimiter:</span> &quot;,&quot;
<span class=" -Color -Color-Green">dbl</span> (16): male, age, education, currentSmoker, cigsPerDay, BPMeds, prevalent...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">ℹ</span> Use `spec()` to retrieve the full column specification for this data.
<span class=" -Color -Color-Cyan">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.
</pre></div>
</div>
<div class="output text_html"><table class="dataframe">
<caption>A tibble: 6 × 2</caption>
<thead>
	<tr><th scope=col>BMI</th><th scope=col>totChol</th></tr>
	<tr><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>26.97</td><td>195</td></tr>
	<tr><td>28.73</td><td>250</td></tr>
	<tr><td>25.34</td><td>245</td></tr>
	<tr><td>28.58</td><td>225</td></tr>
	<tr><td>23.10</td><td>285</td></tr>
	<tr><td>30.30</td><td>228</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>We will define a local function <code class="docutils literal notranslate"><span class="pre">print_html</span></code> to print the HTML output from <code class="docutils literal notranslate"><span class="pre">stargazer</span></code> in the notebook</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># print html convenience function</span>

<span class="n">print_html</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">input</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span>
<span class="w">    </span><span class="nf">capture.output</span><span class="p">(</span><span class="n">input</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="w">    </span><span class="nf">paste</span><span class="p">(</span><span class="n">collapse</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="w">    </span><span class="n">IRdisplay</span><span class="o">::</span><span class="nf">display_html</span><span class="p">()</span>
<span class="w">    </span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<section id="part-1">
<h3>Part 1<a class="headerlink" href="#part-1" title="Permalink to this heading">#</a></h3>
<p>Build a linear model using the <code class="docutils literal notranslate"><span class="pre">lm</span></code> function and store it as <code class="docutils literal notranslate"><span class="pre">myfit_BMI</span></code></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">totChol</span></code>: dependent/response variable</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BMI</span></code>: independent/explanatory variable</p></li>
</ul>
<p>Create a <code class="docutils literal notranslate"><span class="pre">stargazer</span></code> table and print it</p>
<ul class="simple">
<li><p>Explain the coefficients</p></li>
<li><p>Explain the model fit</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">stargazer</span><span class="p">)</span>

<span class="c1"># start here</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># solution</span>

<span class="n">myfit_BMI</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">totChol</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">BMI</span><span class="p">,</span><span class="w"> </span><span class="n">BMI_totChol</span><span class="p">)</span>

<span class="nf">stargazer</span><span class="p">(</span><span class="n">myfit_BMI</span><span class="p">,</span><span class="w"> </span><span class="n">ci</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s">&quot;html&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">print_html</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table style="text-align:center"><tr><td colspan="2" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left"></td><td><em>Dependent variable:</em></td></tr><tr><td></td><td colspan="1" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left"></td><td>totChol</td></tr><tr><td colspan="2" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left">BMI</td><td>1.219<sup>***</sup></td></tr><tr><td style="text-align:left"></td><td>(0.861, 1.577)</td></tr><tr><td style="text-align:left"></td><td></td></tr><tr><td style="text-align:left">Constant</td><td>204.776<sup>***</sup></td></tr><tr><td style="text-align:left"></td><td>(195.458, 214.093)</td></tr><tr><td style="text-align:left"></td><td></td></tr><tr><td colspan="2" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left">Observations</td><td>3,547</td></tr><tr><td style="text-align:left">R<sup>2</sup></td><td>0.012</td></tr><tr><td style="text-align:left">Adjusted R<sup>2</sup></td><td>0.012</td></tr><tr><td style="text-align:left">Residual Std. Error</td><td>43.528 (df = 3545)</td></tr><tr><td style="text-align:left">F Statistic</td><td>44.506<sup>***</sup> (df = 1; 3545)</td></tr><tr><td colspan="2" style="border-bottom: 1px solid black"></td></tr><tr><td style="text-align:left"><em>Note:</em></td><td style="text-align:right"><sup>*</sup>p<0.1; <sup>**</sup>p<0.05; <sup>***</sup>p<0.01</td></tr></table></div></div>
</details>
</div>
</section>
<section id="part-2">
<h3>Part 2<a class="headerlink" href="#part-2" title="Permalink to this heading">#</a></h3>
<p>Use <code class="docutils literal notranslate"><span class="pre">ggcoefstats</span></code> to plot the coefficient(s) in the model. You may exclude the intercept from the plot</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">ggstatsplot</span><span class="p">)</span>

<span class="c1"># start here</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># solution</span>

<span class="c1"># set plot dimensions</span>
<span class="nf">options</span><span class="p">(</span><span class="n">repr.plot.width</span><span class="o">=</span><span class="m">8</span><span class="p">,</span><span class="w"> </span><span class="n">repr.plot.height</span><span class="o">=</span><span class="m">8</span><span class="p">)</span>

<span class="n">myfit_BMI</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">ggcoefstats</span><span class="p">(</span><span class="n">exclude.intercept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/2af2476fb57bcd797e5634a2c9306a7bf03db57af21a07f424c9bf60b79afb4f.png" src="../_images/2af2476fb57bcd797e5634a2c9306a7bf03db57af21a07f424c9bf60b79afb4f.png" />
</div>
</details>
</div>
</section>
<section id="part-3">
<h3>Part 3<a class="headerlink" href="#part-3" title="Permalink to this heading">#</a></h3>
<p>Create a diagnostic plot for the model using <code class="docutils literal notranslate"><span class="pre">autoplot</span></code> from <code class="docutils literal notranslate"><span class="pre">ggfortify</span></code></p>
<ul class="simple">
<li><p>Interpret the plot</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">ggfortify</span><span class="p">)</span>

<span class="c1"># start here</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># solution</span>

<span class="c1"># set plot dimensions</span>
<span class="nf">options</span><span class="p">(</span><span class="n">repr.plot.width</span><span class="o">=</span><span class="m">8</span><span class="p">,</span><span class="w"> </span><span class="n">repr.plot.height</span><span class="o">=</span><span class="m">4</span><span class="p">)</span>

<span class="n">myfit_BMI</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">autoplot</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/9c70331595e3d63194d48bd49b404d828c61c1ff01883109f28b24ed155665ff.png" src="../_images/9c70331595e3d63194d48bd49b404d828c61c1ff01883109f28b24ed155665ff.png" />
</div>
</details>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "r"
        },
        kernelOptions: {
            name: "ir",
            path: "./03-intro-to-stats"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ir'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="../00-md/overview-modeling.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Statistical Modeling</p>
      </div>
    </a>
    <a class="right-next"
       href="07-1-modeling.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Linear Modeling - Multiple</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Linear Modeling - Simple</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-preparation">Data preparation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-can-we-estimate-the-linear-relationship">How can we estimate the linear relationship?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-the-lm-function-for-linear-modeling">Using the <code class="docutils literal notranslate"><span class="pre">lm</span></code> function for linear modeling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resampling-approach">1. Resampling approach</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#significance-testing-of-coefficients">Significance testing of coefficients</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-the-b-0-and-b-1-coefficients">1.1. Calculate the <span class="math notranslate nohighlight">\(b_0\)</span> and <span class="math notranslate nohighlight">\(b_1\)</span> coefficients</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#generate-a-null-distribution-by-resampling">1.2. Generate a null distribution by resampling</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#use-the-null-distribution-to-calculate-the-p-value">1.3. Use the null distribution to calculate the p-value</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#confidence-interval-by-bootstrap">Confidence interval by bootstrap</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#generate-bootstrap-samples-of-dataset">1. Generate bootstrap samples of dataset</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#use-the-bootstrap-distribution-to-calculate-the-confidence-interval">1.2. Use the bootstrap distribution to calculate the confidence interval</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analytical-approach">2. Analytical approach</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Significance testing of coefficients</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-the-test-statistic">2.1. Calculate the test statistic</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#use-the-theoretical-null-distribution-to-calculate-the-p-value">2.2. Use the theoretical null distribution to calculate the p-value</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#confidence-interval-of-coefficients">Confidence interval of coefficients</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-library-functions">Using library functions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-well-does-the-model-fit-the-data">How well does the model fit the data?</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#goodness-of-fit">1. Goodness of fit</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#diagnostic-plots">2. Diagnostic plots</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#application-statistical-table-and-plotting">Application: Statistical table and plotting</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#statistical-table">1. Statistical table</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#statistical-plot">2. Statistical plot</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#diagnostic-plot">3. Diagnostic plot</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-modeling-simple">Exercise - Modeling (Simple)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#part-1">Part 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#part-2">Part 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#part-3">Part 3</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Kenneth Ban, NUS Medicine
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022-23.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>