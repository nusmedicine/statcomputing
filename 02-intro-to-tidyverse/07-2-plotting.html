

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Visualizing Data - Plots &#8212; Statistical Computing for Health Informatics with R/Tidyverse</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '02-intro-to-tidyverse/07-2-plotting';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Visualizing Data - Extensions" href="07-3-plotting.html" />
    <link rel="prev" title="Visualizing Data - Overview" href="07-1-plotting.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../00-md/intro.html">
  
  
  
  
  
    <p class="title logo__title">Statistical Computing for Health Informatics with R/Tidyverse</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../00-md/intro.html">
                    Welcome
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Overview</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../01-intro-to-r/00-intro.html">Computational Thinking for Problem Solving</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction to R</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../00-md/intro-to-r.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01-intro-to-r/01-variables-data.html">Variables, Data Types and Structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01-intro-to-r/02-operations.html">Operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01-intro-to-r/03-decision.html">Decision making</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01-intro-to-r/04-iteration.html">Iterating</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01-intro-to-r/05-functions.html">Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01-intro-to-r/06-extending.html">Extending R</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction to Tidyverse</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="01-overview.html">Overview of Tidyverse</a></li>
<li class="toctree-l1"><a class="reference internal" href="02-reading.html">Reading and Inspecting Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="03-extracting.html">Extracting and Arranging Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="04-transforming.html">Transforming Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="05-tidying.html">Tidying data</a></li>
<li class="toctree-l1"><a class="reference internal" href="06-joining.html">Joining data</a></li>
<li class="toctree-l1"><a class="reference internal" href="07-1-plotting.html">Visualizing Data - Overview</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Visualizing Data - Plots</a></li>




<li class="toctree-l1"><a class="reference internal" href="07-3-plotting.html">Visualizing Data - Extensions</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction to Statistical Computing</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../00-md/intro-to-stats.html">Introduction to Statistical Computing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03-intro-to-stats/01-descriptive.html">Descriptive statistics</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../00-md/overview-inferential.html">Inferential Statistics</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../03-intro-to-stats/02-inferential.html">Inferential Statistics</a></li>

<li class="toctree-l2"><a class="reference internal" href="../03-intro-to-stats/02-1-estimation.html">Estimating Mean/Variance of a Population</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03-intro-to-stats/02-2-estimation.html">Estimating Uncertainty</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03-intro-to-stats/02-3-hypothesis.html">Hypothesis testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03-intro-to-stats/02-4-effect.html">Effect size</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../00-md/overview-tests.html">Statistical Tests</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../03-intro-to-stats/03-1-ttest.html">Comparing measures from 2 groups (unrelated subjects)</a></li>

<li class="toctree-l2"><a class="reference internal" href="../03-intro-to-stats/04-1-anova.html">Comparing measures from &gt;2 groups (unrelated subjects)</a></li>

<li class="toctree-l2"><a class="reference internal" href="../03-intro-to-stats/05-1-fishers.html">Comparing counts between 2x2 categories (unrelated subjects)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03-intro-to-stats/05-2-chisq.html">Comparing counts between &gt;2x2 categories (unrelated subjects)</a></li>

<li class="toctree-l2"><a class="reference internal" href="../03-intro-to-stats/06-correlation.html">Correlating 2 measures</a></li>

</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../00-md/overview-modeling.html">Statistical Modeling</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../03-intro-to-stats/07-modeling.html">Linear Modeling - Simple</a></li>

<li class="toctree-l2"><a class="reference internal" href="../03-intro-to-stats/07-1-modeling.html">Linear Modeling - Multiple</a></li>

<li class="toctree-l2"><a class="reference internal" href="../03-intro-to-stats/07-2-modeling.html">Linear Modeling - Categorical</a></li>

<li class="toctree-l2"><a class="reference internal" href="../03-intro-to-stats/07-3-modeling.html">Generalized Linear Model - Categorical outcome</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03-intro-to-stats/08-1-prediction.html">Modeling for Prediction</a></li>

<li class="toctree-l2"><a class="reference internal" href="../03-intro-to-stats/08-2-explanation.html">Modeling for Explanation</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/02-intro-to-tidyverse/07-2-plotting.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Visualizing Data - Plots</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Visualizing Data - Plots</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-preparation">Data preparation</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#data-visualization-pt-1">Data Visualization (Pt 1)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#categorical-data-1-variable">1. Categorical data (1 variable)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#barchart">1.1. Barchart</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacked-barchart-1-variable">1.2. Stacked barchart (1 variable)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacked-proportional-barchart-1-variable">1.3. Stacked proportional barchart (1 variable)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#categorical-data-2-variables">2. Categorical data (2 variables)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacked-barchart">2.1. Stacked barchart</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#grouped-barchart">2.2. Grouped barchart</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacked-proportional-barchart">2.3. Stacked proportional barchart</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#categorical-data-2-variables-using-facet-layer">Categorical data (2 variables) using <code class="docutils literal notranslate"><span class="pre">facet</span></code> layer</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">2. Categorical data (&gt;2 variables)</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#data-visualization-pt-2">Data Visualization (Pt 2)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#continuous-data-1-variable">3. Continuous data (1 variable)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#histogram">3.1. Histogram</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#density-plot">3.2. Density plot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#boxplot">3.3. Boxplot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#violin-plot">3.4. Violin plot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#quantile-quantile-qq-plot">3.5. Quantile-quantile (QQ) plot</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#continuous-data-1-variable-with-categorical-variable-s">4. Continuous data (1 variable) with categorical variable(s)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">4.1. Histogram</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">4.2. Boxplot</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#data-visualization-pt-3">Data Visualization (Pt 3)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#continuous-2-variables">5. Continuous (2 variables)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#continuous-data-2-variables-with-categorical-variable-s">6. Continuous data (2 variables) with categorical variable(s)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mapping-categories-to-points">6.1. Mapping categories to points</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#faceting">6.2. Faceting</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-visualizing-data">Exercise - Visualizing Data</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-1">Part 1</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-2">Part 2</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-3">Part 3</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-4">Part 4</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-5">Part 5</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="visualizing-data-plots">
<h1>Visualizing Data - Plots<a class="headerlink" href="#visualizing-data-plots" title="Permalink to this heading">#</a></h1>
<p>We can visualize continuous and categorical data using different <code class="docutils literal notranslate"><span class="pre">ggplot</span></code> functions and we will be exploring the following types of plots</p>
<ul class="simple">
<li><p>Categorical (1 variable)</p></li>
<li><p>Categorical (&gt;1 variables)</p></li>
<li><p>Continuous (1 variable)</p></li>
<li><p>Continuous (1 variable) with Categorical variable(s)</p></li>
<li><p>Continuous (2 variables)</p></li>
<li><p>Continuous (2 variables) with categorical variable(s)</p></li>
</ul>
<hr class="docutils" />
<section id="data-preparation">
<h2>Data preparation<a class="headerlink" href="#data-preparation" title="Permalink to this heading">#</a></h2>
<p>We will use an example dataset to illustrate the basic types of plots in <code class="docutils literal notranslate"><span class="pre">ggplot</span></code></p>
<p>We will import a dataset from the Framingham study, which was a long term study of cardiovascular disease about subjects in Framingham, USA. In this dataset</p>
<ul class="simple">
<li><p>~4000 subjects followed up and clinical data and chronic heart disease outcomes were examined longitudinally over &gt; 10 years</p></li>
</ul>
<p>The variables include</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">male</span></code> : 0 = female, 1 = male</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">age</span></code> : Age at the time of medical examination in years.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">education</span></code> : 1 = Some high school, 2 = high school/GED, 3 = some college/vocational school, 4 = college</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">currentSmoker</span></code>: Current cigarette smoking at the time of examinations</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cigsPerDay</span></code>: Number of cigarettes smoked each day</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BPmeds</span></code>: Use of Anti-hypertensive medication at exam</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prevalentStroke</span></code>: Prevalent Stroke</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prevalentHyp</span></code>: Prevalent Hypertensive</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">diabetes</span></code>: Diabetic according to criteria of first exam treated</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">totChol</span></code>: Total cholesterol (mg/dL)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sysBP</span></code>: Systolic Blood Pressure (mmHg)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">diaBP</span></code>: Diastolic blood pressure (mmHg)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BMI</span></code>: Body Mass Index, weight (kg)/height (m)^2</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">heartRate</span></code>: Heart rate (beats/minute)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">glucose</span></code>: Blood glucose level (mg/dL)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span>

<span class="n">data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read_csv</span><span class="p">(</span><span class="s">&quot;https://raw.githubusercontent.com/kennethban/dataset/main/framingham.csv&quot;</span><span class="p">)</span>

<span class="c1"># renaming column &amp; changing data type of columns</span>
<span class="n">data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="w">        </span><span class="nf">rename</span><span class="p">(</span><span class="n">sex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">male</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="w">        </span><span class="nf">mutate</span><span class="p">(</span><span class="n">sex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">sex</span><span class="p">),</span>
<span class="w">               </span><span class="n">age</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.integer</span><span class="p">(</span><span class="n">age</span><span class="p">),</span>
<span class="w">               </span><span class="n">education</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">education</span><span class="p">),</span>
<span class="w">               </span><span class="n">currentSmoker</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">currentSmoker</span><span class="p">),</span>
<span class="w">               </span><span class="n">cigsPerDay</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.integer</span><span class="p">(</span><span class="n">cigsPerDay</span><span class="p">),</span>
<span class="w">               </span><span class="n">BPMeds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">BPMeds</span><span class="p">),</span>
<span class="w">               </span><span class="n">prevalentStroke</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">prevalentStroke</span><span class="p">),</span>
<span class="w">               </span><span class="n">prevalentHyp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">prevalentHyp</span><span class="p">),</span>
<span class="w">               </span><span class="n">diabetes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">diabetes</span><span class="p">),</span>
<span class="w">               </span><span class="n">totChol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.integer</span><span class="p">(</span><span class="n">totChol</span><span class="p">),</span>
<span class="w">               </span><span class="n">heartRate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.integer</span><span class="p">(</span><span class="n">heartRate</span><span class="p">),</span>
<span class="w">               </span><span class="n">TenYearCHD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">TenYearCHD</span><span class="p">)</span>
<span class="w">               </span><span class="p">)</span>

<span class="c1"># transforming any units</span>
<span class="n">data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="w">        </span><span class="nf">mutate</span><span class="p">(</span><span class="n">glucose</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">glucose</span><span class="o">/</span><span class="m">18</span><span class="p">,</span><span class="w"> </span><span class="n">digits</span><span class="o">=</span><span class="m">1</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="c1"># mg/dL to mmol/L</span>
<span class="w">        </span><span class="nf">mutate</span><span class="p">(</span><span class="n">totChol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">totChol</span><span class="o">/</span><span class="m">39</span><span class="p">,</span><span class="w"> </span><span class="n">digits</span><span class="o">=</span><span class="m">1</span><span class="p">))</span><span class="w">     </span><span class="c1"># mg/dL to mmol/L</span>

<span class="nf">head</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>── <span class=" -Color -Color-Bold">Attaching core tidyverse packages</span> ───────────────────────────── tidyverse 2.0.0 ──
<span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">dplyr    </span> 1.1.1     <span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">readr    </span> 2.1.4
<span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">forcats  </span> 1.0.0     <span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">stringr  </span> 1.5.0
<span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">ggplot2  </span> 3.4.2     <span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">tibble   </span> 3.2.1
<span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">lubridate</span> 1.9.2     <span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">tidyr    </span> 1.3.0
<span class=" -Color -Color-Green">✔</span> <span class=" -Color -Color-Blue">purrr    </span> 1.0.1     
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>── <span class=" -Color -Color-Bold">Conflicts</span> ─────────────────────────────────────────────── tidyverse_conflicts() ──
<span class=" -Color -Color-Red">✖</span> <span class=" -Color -Color-Blue">dplyr</span>::<span class=" -Color -Color-Green">filter()</span> masks <span class=" -Color -Color-Blue">stats</span>::filter()
<span class=" -Color -Color-Red">✖</span> <span class=" -Color -Color-Blue">dplyr</span>::<span class=" -Color -Color-Green">lag()</span>    masks <span class=" -Color -Color-Blue">stats</span>::lag()
<span class=" -Color -Color-Cyan">ℹ</span> Use the conflicted package (<span class=" -Color -Color-Blue">&lt;http://conflicted.r-lib.org/&gt;</span>) to force all conflicts to become errors
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">Rows: </span><span class=" -Color -Color-Blue">4240</span> <span class=" -Color -Color-Bold">Columns: </span><span class=" -Color -Color-Blue">16</span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">──</span> <span class=" -Color -Color-Bold">Column specification</span> <span class=" -Color -Color-Cyan">─────────────────────────────────────────────────────────────</span>
<span class=" -Color -Color-Bold">Delimiter:</span> &quot;,&quot;
<span class=" -Color -Color-Green">dbl</span> (16): male, age, education, currentSmoker, cigsPerDay, BPMeds, prevalent...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">ℹ</span> Use `spec()` to retrieve the full column specification for this data.
<span class=" -Color -Color-Cyan">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.
</pre></div>
</div>
<div class="output text_html"><table class="dataframe">
<caption>A tibble: 6 × 16</caption>
<thead>
	<tr><th scope=col>sex</th><th scope=col>age</th><th scope=col>education</th><th scope=col>currentSmoker</th><th scope=col>cigsPerDay</th><th scope=col>BPMeds</th><th scope=col>prevalentStroke</th><th scope=col>prevalentHyp</th><th scope=col>diabetes</th><th scope=col>totChol</th><th scope=col>sysBP</th><th scope=col>diaBP</th><th scope=col>BMI</th><th scope=col>heartRate</th><th scope=col>glucose</th><th scope=col>TenYearCHD</th></tr>
	<tr><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;fct&gt;</th></tr>
</thead>
<tbody>
	<tr><td>1</td><td>39</td><td>4</td><td>0</td><td> 0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>5.0</td><td>106.0</td><td> 70</td><td>26.97</td><td>80</td><td>4.3</td><td>0</td></tr>
	<tr><td>0</td><td>46</td><td>2</td><td>0</td><td> 0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>6.4</td><td>121.0</td><td> 81</td><td>28.73</td><td>95</td><td>4.2</td><td>0</td></tr>
	<tr><td>1</td><td>48</td><td>1</td><td>1</td><td>20</td><td>0</td><td>0</td><td>0</td><td>0</td><td>6.3</td><td>127.5</td><td> 80</td><td>25.34</td><td>75</td><td>3.9</td><td>0</td></tr>
	<tr><td>0</td><td>61</td><td>3</td><td>1</td><td>30</td><td>0</td><td>0</td><td>1</td><td>0</td><td>5.8</td><td>150.0</td><td> 95</td><td>28.58</td><td>65</td><td>5.7</td><td>1</td></tr>
	<tr><td>0</td><td>46</td><td>3</td><td>1</td><td>23</td><td>0</td><td>0</td><td>0</td><td>0</td><td>7.3</td><td>130.0</td><td> 84</td><td>23.10</td><td>85</td><td>4.7</td><td>0</td></tr>
	<tr><td>0</td><td>43</td><td>2</td><td>0</td><td> 0</td><td>0</td><td>0</td><td>1</td><td>0</td><td>5.8</td><td>180.0</td><td>110</td><td>30.30</td><td>77</td><td>5.5</td><td>0</td></tr>
</tbody>
</table>
</div></div>
</div>
</section>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="data-visualization-pt-1">
<h1>Data Visualization (Pt 1)<a class="headerlink" href="#data-visualization-pt-1" title="Permalink to this heading">#</a></h1>
<ul class="simple">
<li><p><strong>Categorical (1 variable)</strong></p></li>
<li><p><strong>Categorical (&gt;1 variables)</strong></p></li>
<li><p>Continuous (1 variable)</p></li>
<li><p>Continuous (1 variable) with Categorical variable(s)</p></li>
<li><p>Continuous (2 variables)</p></li>
<li><p>Continuous (2 variables) with categorical variable(s)</p></li>
</ul>
<section id="categorical-data-1-variable">
<h2>1. Categorical data (1 variable)<a class="headerlink" href="#categorical-data-1-variable" title="Permalink to this heading">#</a></h2>
<p>We can plot categorical data for 1 variable in the following ways to compare the frequency or proportion of the different categories</p>
<p><img alt="geom_bar_single.png" src="../_images/geom_bar_single.png" /></p>
<section id="barchart">
<h3>1.1. Barchart<a class="headerlink" href="#barchart" title="Permalink to this heading">#</a></h3>
<p>A barchart allows us to compare the frequency counts of the different categories. We use the <code class="docutils literal notranslate"><span class="pre">geom_bar</span></code> function and specify the following</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">aes</span></code> in <code class="docutils literal notranslate"><span class="pre">ggplot</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code> = categorical variable to plot</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">geom_bar</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">fill</span></code> = color of plot</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Basic barchart</span>

<span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">education</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">geom_bar</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="s">&quot;salmon&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/6a99141591448139c5441e5eb7c30f84cabae246440872a74715a9eabd74b39a.png" src="../_images/6a99141591448139c5441e5eb7c30f84cabae246440872a74715a9eabd74b39a.png" />
</div>
</div>
</section>
<section id="stacked-barchart-1-variable">
<h3>1.2. Stacked barchart (1 variable)<a class="headerlink" href="#stacked-barchart-1-variable" title="Permalink to this heading">#</a></h3>
<p>A stacked barchart collapses all the categories to a single bar and the categories are mapped to different colors. The height of the bar is the total frequency count of all the categories. This is not commonly used as it is difficult to visually compare the proportions of different categories</p>
<p>To plot a stacked barchart, we specify the following</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">aes</span></code> in <code class="docutils literal notranslate"><span class="pre">ggplot</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">&quot;all&quot;</span></code> so collapse all categories to single bar</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fill</span></code> = categorical variable to color each category</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">geom_bar</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">position</span> <span class="pre">=</span> <span class="pre">&quot;stack&quot;</span></code> to stack the bars</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">width</span></code>: optional width of bar</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Stacked barchart for 1 categorical variable</span>

<span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">&quot;all&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="n">education</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">    </span><span class="c1"># x=&quot;all&quot;, fill=categorical variable</span>
<span class="w">  </span><span class="nf">geom_bar</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="s">&quot;stack&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="o">=</span><span class="m">0.2</span><span class="p">)</span><span class="w">   </span><span class="c1"># position=&quot;stack&quot;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/14fcc5631fcbb840a50933e78be62ac26d074c5c59bac1d389b3577cb9467d6a.png" src="../_images/14fcc5631fcbb840a50933e78be62ac26d074c5c59bac1d389b3577cb9467d6a.png" />
</div>
</div>
</section>
<section id="stacked-proportional-barchart-1-variable">
<h3>1.3. Stacked proportional barchart (1 variable)<a class="headerlink" href="#stacked-proportional-barchart-1-variable" title="Permalink to this heading">#</a></h3>
<p>A stacked proportional barchart collapses all the categories to a single bar and the categories are mapped to different colors. The height of the bar is normalized to 1 (100%). This chart is useful for comparing the relative proportions of categories</p>
<p>To plot a stacked proportional barchart, we specify the following</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">aes</span></code> in <code class="docutils literal notranslate"><span class="pre">ggplot</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">&quot;all&quot;</span></code> so collapse all categories to single bar</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fill</span></code> = categorical variable to color each category</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">geom_bar</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">position</span> <span class="pre">=</span> <span class="pre">&quot;fill&quot;</span></code> to normalize the height to 1 (or 100%)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">width</span></code>: optional width of bar</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Stacked proportional barchart for 1 categorical variable</span>

<span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">&quot;all&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="n">education</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">     </span><span class="c1"># x=&quot;all&quot;, fill=categorical variable</span>
<span class="w">  </span><span class="nf">geom_bar</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="s">&quot;fill&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="o">=</span><span class="m">0.2</span><span class="p">)</span><span class="w">     </span><span class="c1"># position=&quot;fill&quot; for proportional stack</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3e930c89966773d7533f366d6120f1e018c327f8ce5d317a91442cba46dfb979.png" src="../_images/3e930c89966773d7533f366d6120f1e018c327f8ce5d317a91442cba46dfb979.png" />
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="categorical-data-2-variables">
<h2>2. Categorical data (2 variables)<a class="headerlink" href="#categorical-data-2-variables" title="Permalink to this heading">#</a></h2>
<p>For 2 categorical variables, we can visualize them in the following ways to compare the count/proportion of the first category broken down by the second category</p>
<p><img alt="geom_bar_multiple.png" src="../_images/geom_bar_multiple.png" /></p>
<section id="stacked-barchart">
<h3>2.1. Stacked barchart<a class="headerlink" href="#stacked-barchart" title="Permalink to this heading">#</a></h3>
<p>To plot a stacked barchart for 2 categories, we specify the following</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">aes</span></code> in <code class="docutils literal notranslate"><span class="pre">ggplot</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code> = first categorical variable on x-axis</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fill</span></code> = second categorical variable to breakdown each bar by color</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">geom_bar</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">position</span> <span class="pre">=</span> <span class="pre">&quot;stack&quot;</span></code> to stack the bars</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">width</span></code>: optional width of bar</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># stacked barplot of education and prevalentHyp categorical variables</span>

<span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">education</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="n">prevalentHyp</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">geom_bar</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/e16573bd3e77c96878fcff3369d07327cc7919908fc20915516cfcc313b9ffb7.png" src="../_images/e16573bd3e77c96878fcff3369d07327cc7919908fc20915516cfcc313b9ffb7.png" />
</div>
</div>
</section>
<section id="grouped-barchart">
<h3>2.2. Grouped barchart<a class="headerlink" href="#grouped-barchart" title="Permalink to this heading">#</a></h3>
<p>Instead of stacking 2 categories, we can plot them side by side by specifying the following</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">aes</span></code> in <code class="docutils literal notranslate"><span class="pre">ggplot</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code> = first categorical variable on x-axis</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fill</span></code> = second categorical variable to breakdown each bar by color</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">geom_bar</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">position</span> <span class="pre">=</span> <span class="pre">&quot;dodge&quot;</span></code> to plot the bars side-by-side</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">width</span></code>: optional width of bar`</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># grouped barplot of education and prevalentHyp categorical variables</span>

<span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">education</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="n">prevalentHyp</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">geom_bar</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="s">&quot;dodge&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/5929eaae24b3f567d123e71424743f859ade264a0537c6217d746a418835b7ce.png" src="../_images/5929eaae24b3f567d123e71424743f859ade264a0537c6217d746a418835b7ce.png" />
</div>
</div>
</section>
<section id="stacked-proportional-barchart">
<h3>2.3. Stacked proportional barchart<a class="headerlink" href="#stacked-proportional-barchart" title="Permalink to this heading">#</a></h3>
<p>We can choose to plot the proportions of the variables for easier visual comparison. To plot a stacked proportional barchart for 2 categories, we specify the following</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">aes</span></code> in <code class="docutils literal notranslate"><span class="pre">ggplot</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code> = first categorical variable on x-axis</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fill</span></code> = second categorical variable to breakdown each bar by color</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">geom_bar</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">position</span> <span class="pre">=</span> <span class="pre">&quot;fill&quot;</span></code> to normalize the height to 1 (or 100%)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">width</span></code>: optional width of bar</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># stacked proportional barplot of education and prevalentHyp categorical variables</span>

<span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">education</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="n">prevalentHyp</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">geom_bar</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="s">&quot;fill&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/bffd19f206f5c08985bdff340a89580aa95f37ba771d913603a2bc1c9fa01c4e.png" src="../_images/bffd19f206f5c08985bdff340a89580aa95f37ba771d913603a2bc1c9fa01c4e.png" />
</div>
</div>
</section>
<section id="categorical-data-2-variables-using-facet-layer">
<h3>Categorical data (2 variables) using <code class="docutils literal notranslate"><span class="pre">facet</span></code> layer<a class="headerlink" href="#categorical-data-2-variables-using-facet-layer" title="Permalink to this heading">#</a></h3>
<p>Instead of plotting both categorical variables in one plot, we can split the plot of the first category by the second category using the <code class="docutils literal notranslate"><span class="pre">facet</span></code> layer. Here, we use the <code class="docutils literal notranslate"><span class="pre">facet_grid</span></code> layer</p>
<ul class="simple">
<li><p>We specify <strong>categorical variables</strong> for splitting a plot into subplots using the syntax <code class="docutils literal notranslate"><span class="pre">row</span> <span class="pre">category</span> <span class="pre">~</span> <span class="pre">column</span> <span class="pre">category</span></code> to indicate the layout of plots by row and column</p></li>
<li><p>If we only have 1 category to split a plot in the <code class="docutils literal notranslate"><span class="pre">facet_grid</span></code> layer, we can specify <code class="docutils literal notranslate"><span class="pre">.</span></code> as a placeholder</p></li>
</ul>
<p><img alt="ggplot_facet.png" src="../_images/ggplot_facet.png" /></p>
<p>As an example, we will plot the <code class="docutils literal notranslate"><span class="pre">education</span></code> categorical variable as a barchart and split the plot according to the <code class="docutils literal notranslate"><span class="pre">prevalentHyp</span></code> category</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">aes</span></code> in <code class="docutils literal notranslate"><span class="pre">ggplot</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code> = first categorical variable</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">geom_bar</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">fill</span></code>: optional color (default = black)</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">facet_grid</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">row</span> <span class="pre">~</span> <span class="pre">column</span></code> of each category to split</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># barplot of education faceted by prevalentHyp (column layout)</span>

<span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">education</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">geom_bar</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="s">&quot;salmon&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">facet_grid</span><span class="p">(</span><span class="n">.</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">prevalentHyp</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/e0c5a6f5c84e52fa0f084a82c6e8ca6cc08c23296290bc1da98aa34b857c085c.png" src="../_images/e0c5a6f5c84e52fa0f084a82c6e8ca6cc08c23296290bc1da98aa34b857c085c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># barplot of education faceted by prevalentHyp (row layout)</span>

<span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">education</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">geom_bar</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="s">&quot;salmon&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">facet_grid</span><span class="p">(</span><span class="n">prevalentHyp</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">.</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ce2f0953e7938fa41abced7751a7b14609fff0a49cea7f72481dbb782fea1679.png" src="../_images/ce2f0953e7938fa41abced7751a7b14609fff0a49cea7f72481dbb782fea1679.png" />
</div>
</div>
<p><strong>Adding labels to <code class="docutils literal notranslate"><span class="pre">facet</span></code> plots</strong></p>
<p>The labels in the <code class="docutils literal notranslate"><span class="pre">facet</span></code> plots do not include the variable names by default so it can get confusing</p>
<p>We can specify the <code class="docutils literal notranslate"><span class="pre">labeller</span></code> option in <code class="docutils literal notranslate"><span class="pre">facet_grid</span></code> to add the categorical labels in the plots</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">labeller</span> <span class="o">=</span> <span class="n">labeller</span><span class="p">(</span><span class="o">.</span><span class="n">rows</span> <span class="o">=</span> <span class="n">label_both</span><span class="p">,</span>
                    <span class="o">.</span><span class="n">cols</span> <span class="o">=</span> <span class="n">label_both</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Adding labels using the category names by the labeller option</span>

<span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">education</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">geom_bar</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="s">&quot;salmon&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">facet_grid</span><span class="p">(</span><span class="n">.</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">prevalentHyp</span><span class="p">,</span><span class="w"> </span>
<span class="w">             </span><span class="n">labeller</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">labeller</span><span class="p">(</span><span class="n">.rows</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">label_both</span><span class="p">,</span><span class="w"> </span>
<span class="w">                                 </span><span class="n">.cols</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">label_both</span><span class="p">))</span><span class="w"> </span><span class="c1"># labelling</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/a59dfde504291b87b8f97182f83cbc577438fd709f13e97ab4ed455d61291fd4.png" src="../_images/a59dfde504291b87b8f97182f83cbc577438fd709f13e97ab4ed455d61291fd4.png" />
</div>
</div>
<p>If we want to override the labels taken from the categorical variables, we can explicitly substitute the labels. To do this, we specify the <code class="docutils literal notranslate"><span class="pre">labeller</span></code> option in <code class="docutils literal notranslate"><span class="pre">facet_grid</span></code> and indicate the new labels for each category in the following manner</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">labeller</span> <span class="o">=</span> <span class="n">labeller</span><span class="p">(</span><span class="n">category1</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="s2">&quot;old_label1&quot;</span> <span class="o">=</span> <span class="s2">&quot;new_label1&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;old_label2&quot;</span> <span class="o">=</span> <span class="s2">&quot;new_label2&quot;</span><span class="p">,</span>
                                   <span class="o">...</span><span class="p">),</span>
                    <span class="n">category2</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="s2">&quot;old_label1&quot;</span> <span class="o">=</span> <span class="s2">&quot;new_label1&quot;</span><span class="p">,</span>
                                  <span class="s2">&quot;old_label2&quot;</span> <span class="o">=</span> <span class="s2">&quot;new_label2&quot;</span><span class="p">,</span>
                                  <span class="o">...</span><span class="p">),</span>
                    <span class="o">...</span>
                    <span class="p">)</span>               
                                  
</pre></div>
</div>
<p>For example, for <code class="docutils literal notranslate"><span class="pre">prevalentHyp</span></code> we want to label <code class="docutils literal notranslate"><span class="pre">0</span></code> as <code class="docutils literal notranslate"><span class="pre">Normal</span> <span class="pre">BP</span></code> and <code class="docutils literal notranslate"><span class="pre">1</span></code> as <code class="docutils literal notranslate"><span class="pre">Hypertensive</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Using explicit labels for prevalentHyp</span>

<span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">education</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">geom_bar</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="s">&quot;salmon&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">facet_grid</span><span class="p">(</span><span class="n">.</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">prevalentHyp</span><span class="p">,</span><span class="w"> </span>
<span class="w">             </span><span class="n">labeller</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">labeller</span><span class="p">(</span><span class="n">prevalentHyp</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;0&quot;</span><span class="o">=</span><span class="s">&quot;Normal BP&quot;</span><span class="p">,</span><span class="w"> </span>
<span class="w">                                                </span><span class="s">&quot;1&quot;</span><span class="o">=</span><span class="s">&quot;Hypertensive&quot;</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4b13c32e44fb15c79d1a06cf3d864c1e2820c3147fa58a2a23cb6606148bead3.png" src="../_images/4b13c32e44fb15c79d1a06cf3d864c1e2820c3147fa58a2a23cb6606148bead3.png" />
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="id1">
<h2>2. Categorical data (&gt;2 variables)<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h2>
<p>We can combine the different options (<code class="docutils literal notranslate"><span class="pre">fill</span></code> and <code class="docutils literal notranslate"><span class="pre">facet</span></code>) to compare 3 categorical variables.</p>
<p>Let take an example where we interested in looking at the number/proportion of people with hypertension by their smoking status and gender</p>
<ul class="simple">
<li><p>We start with a barplot of <code class="docutils literal notranslate"><span class="pre">prevalentHyp</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">aes</span></code> in <code class="docutils literal notranslate"><span class="pre">ggplot</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">prevalentHyp</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fill</span> <span class="pre">=</span> <span class="pre">prevalentHyp</span></code> to color the prevalentHyp categories</p></li>
</ul>
</li>
</ul>
</li>
<li><p>We split the plot by <code class="docutils literal notranslate"><span class="pre">currentSmoker</span></code> and <code class="docutils literal notranslate"><span class="pre">sex</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">facet_grid</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">row</span> <span class="pre">~</span> <span class="pre">column</span> <span class="pre">categories</span></code>: <code class="docutils literal notranslate"><span class="pre">currentSmoker</span> <span class="pre">~</span> <span class="pre">sex</span></code></p></li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># barplot of prevalentHyp split by currentSmoker and sex</span>

<span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">prevalentHyp</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="n">prevalentHyp</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">geom_bar</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">facet_grid</span><span class="p">(</span><span class="n">currentSmoker</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">sex</span><span class="p">,</span><span class="w"> </span><span class="c1"># row ~ column layout</span>
<span class="w">             </span><span class="n">labeller</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">labeller</span><span class="p">(</span><span class="n">.rows</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">label_both</span><span class="p">,</span><span class="w"> </span>
<span class="w">                                 </span><span class="n">.cols</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">label_both</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/aea380ee61eb098a46a1e6b7e287dd421ac2de773ad8abcade600b24cfb1eab4.png" src="../_images/aea380ee61eb098a46a1e6b7e287dd421ac2de773ad8abcade600b24cfb1eab4.png" />
</div>
</div>
<p>We can also stack the <code class="docutils literal notranslate"><span class="pre">prevalentHyp</span></code> categories into a single bar by setting <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">&quot;all&quot;</span></code> under the <code class="docutils literal notranslate"><span class="pre">aes</span></code> mapping in <code class="docutils literal notranslate"><span class="pre">ggplot</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">&quot;all&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="n">prevalentHyp</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="c1"># stack prevalentHyp</span>
<span class="w">  </span><span class="nf">geom_bar</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">facet_grid</span><span class="p">(</span><span class="n">currentSmoker</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">sex</span><span class="p">,</span><span class="w"> </span>
<span class="w">             </span><span class="n">labeller</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">labeller</span><span class="p">(</span><span class="n">.rows</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">label_both</span><span class="p">,</span><span class="w"> </span>
<span class="w">                                 </span><span class="n">.cols</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">label_both</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/b919c6a45b959ce528429f1cf95a5b76f0b026f7d589e708cdfc654af6bf1c25.png" src="../_images/b919c6a45b959ce528429f1cf95a5b76f0b026f7d589e708cdfc654af6bf1c25.png" />
</div>
</div>
<p>As the counts are hard to compare on stacked barcharts, we change it to show proportions by setting <code class="docutils literal notranslate"><span class="pre">position=&quot;fill&quot;</span></code> in <code class="docutils literal notranslate"><span class="pre">geom_bar</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">&quot;all&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="n">prevalentHyp</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">geom_bar</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="s">&quot;fill&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="c1"># change to proportion</span>
<span class="w">  </span><span class="nf">facet_grid</span><span class="p">(</span><span class="n">currentSmoker</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">sex</span><span class="p">,</span><span class="w"> </span>
<span class="w">             </span><span class="n">labeller</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">labeller</span><span class="p">(</span><span class="n">.rows</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">label_both</span><span class="p">,</span><span class="w"> </span>
<span class="w">                                 </span><span class="n">.cols</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">label_both</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/221342499bb8abd900ca1207469090d9858f82cb0ef4d5359ca24f2471429865.png" src="../_images/221342499bb8abd900ca1207469090d9858f82cb0ef4d5359ca24f2471429865.png" />
</div>
</div>
<p>As it is difficult to compare the proportions between the top and bottom rows, we can layout the plots horizontally by columns by extending the <code class="docutils literal notranslate"><span class="pre">row</span> <span class="pre">~</span> <span class="pre">column</span></code> syntax using the <code class="docutils literal notranslate"><span class="pre">+</span></code> operator to combine 2 categorical variables (e.g. <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code>) in the row or column positions</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">.</span> <span class="pre">~</span> <span class="pre">A</span> <span class="pre">+</span> <span class="pre">B</span></code>: plot combinations of 2 categories (e.g. <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code>) column-wise</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">+</span> <span class="pre">B</span> <span class="pre">~</span> <span class="pre">.</span></code>: plot combinations of 2 categories (e.g. <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">B</span></code>) row-wise</p></li>
</ul>
<p><img alt="ggplot_facet_plus.png" src="../_images/ggplot_facet_plus.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot facets column-wise for combinations of sex and currentSmoker</span>

<span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">&quot;all&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="n">prevalentHyp</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">geom_bar</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="s">&quot;fill&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">facet_grid</span><span class="p">(</span><span class="n">.</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">sex</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">currentSmoker</span><span class="p">,</span><span class="w"> </span>
<span class="w">             </span><span class="n">labeller</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">labeller</span><span class="p">(</span><span class="n">.rows</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">label_both</span><span class="p">,</span><span class="w"> </span>
<span class="w">                                 </span><span class="n">.cols</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">label_both</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/a9f5c3d4b8a9d97c627a06688b65ccc13602e6ef5109a148b334fb187a6a0acf.png" src="../_images/a9f5c3d4b8a9d97c627a06688b65ccc13602e6ef5109a148b334fb187a6a0acf.png" />
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="data-visualization-pt-2">
<h1>Data Visualization (Pt 2)<a class="headerlink" href="#data-visualization-pt-2" title="Permalink to this heading">#</a></h1>
<ul class="simple">
<li><p>Categorical (1 variable)</p></li>
<li><p>Categorical (&gt;1 variables)</p></li>
<li><p><strong>Continuous (1 variable)</strong></p></li>
<li><p><strong>Continuous (1 variable) with Categorical variable(s)</strong></p></li>
<li><p>Continuous (2 variables)</p></li>
<li><p>Continuous (2 variables) with categorical variable(s)</p></li>
</ul>
<hr class="docutils" />
<section id="continuous-data-1-variable">
<h2>3. Continuous data (1 variable)<a class="headerlink" href="#continuous-data-1-variable" title="Permalink to this heading">#</a></h2>
<p>Continuous/quantitative data for 1 variable can be visualized in the follow ways</p>
<ul class="simple">
<li><p><strong>Histogram, density, box and violin plots</strong> show the distribution of values</p></li>
<li><p><strong>QQ plot</strong> is a specialized plot to help assess if the values are normally distributed</p></li>
</ul>
<p><img alt="ggplot_distribution.png" src="../_images/ggplot_distribution.png" /></p>
<section id="histogram">
<h3>3.1. Histogram<a class="headerlink" href="#histogram" title="Permalink to this heading">#</a></h3>
<p>A histogram plots the frequency distribution of values</p>
<ul class="simple">
<li><p>Values are binned according to ranges in the x-axis</p></li>
<li><p>The frequency of values in each bin is shown in the y-axis</p></li>
</ul>
<p>To plot a histogram, we use the <code class="docutils literal notranslate"><span class="pre">geom_histogram</span></code> function and specify the following</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">aes</span></code> in <code class="docutils literal notranslate"><span class="pre">ggplot</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code> = continuous variable</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">geom_histogram</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">binwidth</span></code>: option to indicate range of bin</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bins</span></code>: option to indicate number of bins</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fill</span></code>: optional color</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># default bins = 30</span>

<span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">BMI</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">geom_histogram</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="s">&quot;salmon&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning message:
“Removed 19 rows containing non-finite values (`stat_bin()`).”
</pre></div>
</div>
<img alt="../_images/8835511d3cbce5acf1c573a8b185fed0a4f6b676e8dc0f33c05e65b9f4b3fe86.png" src="../_images/8835511d3cbce5acf1c573a8b185fed0a4f6b676e8dc0f33c05e65b9f4b3fe86.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># changing the binwidth</span>

<span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">BMI</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">geom_histogram</span><span class="p">(</span><span class="n">binwidth</span><span class="o">=</span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="s">&quot;salmon&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning message:
“Removed 19 rows containing non-finite values (`stat_bin()`).”
</pre></div>
</div>
<img alt="../_images/7db97a0a99a7b9cd81c9431956df720a63412c0c7e4a692aa1edbb85e1992055.png" src="../_images/7db97a0a99a7b9cd81c9431956df720a63412c0c7e4a692aa1edbb85e1992055.png" />
</div>
</div>
</section>
<section id="density-plot">
<h3>3.2. Density plot<a class="headerlink" href="#density-plot" title="Permalink to this heading">#</a></h3>
<p>A density plot smooths the distribution over continuous values by and is a useful alternative to a histogram. The total density (area under the curve) is normalized to 1.</p>
<p>To plot the density of the distribution, we use the <code class="docutils literal notranslate"><span class="pre">geom_density</span></code> function and specify the following</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">aes</span></code> in <code class="docutils literal notranslate"><span class="pre">ggplot</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code>= continuous variable</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">geom_density</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">fill</span></code>: optional color</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">BMI</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">geom_density</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="s">&quot;salmon&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning message:
“Removed 19 rows containing non-finite values (`stat_density()`).”
</pre></div>
</div>
<img alt="../_images/8d466d8b6c756472d0e6bbcda8cf8f670c9dedc25b1e60f6f94e321779511093.png" src="../_images/8d466d8b6c756472d0e6bbcda8cf8f670c9dedc25b1e60f6f94e321779511093.png" />
</div>
</div>
</section>
<section id="boxplot">
<h3>3.3. Boxplot<a class="headerlink" href="#boxplot" title="Permalink to this heading">#</a></h3>
<p>A boxplot visualizes the distibution as a box with whiskers and shows several summary statistics</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">percentiles</span></code>: 25th, 50th (median), 75th</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">upper</span> <span class="pre">hinge</span></code>: 75th percentile + 1.5 x (75th - 25th percentile)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lower</span> <span class="pre">hinge</span></code>: 25th percentile - 1.5 x (75th - 25th percentile)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">outliers</span></code>: values outside the upper/lower hinge</p></li>
</ul>
<p><img alt="boxplot.png" src="../_images/boxplot.png" /></p>
<p>To plot a boxplot, we use the <code class="docutils literal notranslate"><span class="pre">geom_boxplot</span></code> function</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">aes</span></code> in <code class="docutils literal notranslate"><span class="pre">ggplot</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">all</span></code>: include all categories for the continuous variable</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">y</span></code> = continuous variable</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">geom_boxplot</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">fill</span></code>: optional color</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">width</span></code>: optional width of box</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># boxplot of BMI</span>

<span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">&quot;all&quot;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">BMI</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">geom_boxplot</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="m">0.25</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning message:
“Removed 19 rows containing non-finite values (`stat_boxplot()`).”
</pre></div>
</div>
<img alt="../_images/f02c5b840490713e55e4d56bbf88f4abd2efe122956f4a7f7f94ae2f0f352192.png" src="../_images/f02c5b840490713e55e4d56bbf88f4abd2efe122956f4a7f7f94ae2f0f352192.png" />
</div>
</div>
</section>
<section id="violin-plot">
<h3>3.4. Violin plot<a class="headerlink" href="#violin-plot" title="Permalink to this heading">#</a></h3>
<p>A violin plot visualizes the distribution of values similar to a density plot but rotated vertically like a boxplot</p>
<p>To plot a violin plot, we use the <code class="docutils literal notranslate"><span class="pre">geom_violin</span></code> function and specify the following</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">aes</span></code> in <code class="docutils literal notranslate"><span class="pre">ggplot</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">all</span></code>: include all categories for the continuous variable</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">y</span></code>= continuous variable</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">geom_violin</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">fill</span></code>: optional color</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">width</span></code>: optional width of violin</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># violin plot of BMI</span>

<span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">&quot;all&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">BMI</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">geom_violin</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="m">0.25</span><span class="p">)</span><span class="w"> </span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning message:
“Removed 19 rows containing non-finite values (`stat_ydensity()`).”
</pre></div>
</div>
<img alt="../_images/09dfff8c75da8a2e286b881374488180679775937497811d6a4d56f62a297505.png" src="../_images/09dfff8c75da8a2e286b881374488180679775937497811d6a4d56f62a297505.png" />
</div>
</div>
</section>
<section id="quantile-quantile-qq-plot">
<h3>3.5. Quantile-quantile (QQ) plot<a class="headerlink" href="#quantile-quantile-qq-plot" title="Permalink to this heading">#</a></h3>
<p>A QQ plot is used to assess if the distribution of values follows a normal (Gaussian) distribution</p>
<p><img alt="qqplot.png" src="../_images/qqplot.png" /></p>
<p>From <a class="reference external" href="https://mgimond.github.io/ES218/Week06a.html">https://mgimond.github.io/ES218/Week06a.html</a></p>
<p>To demonstrate the QQ plot, we will first generate some samples from a <code class="docutils literal notranslate"><span class="pre">normal</span></code> distribution</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">data_norm</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">tibble</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="nf">rnorm</span><span class="p">(</span><span class="m">1000</span><span class="p">))</span><span class="w"> </span><span class="c1"># generate 1000 samples from normal distribution</span>

<span class="nf">head</span><span class="p">(</span><span class="n">data_norm</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A tibble: 6 × 1</caption>
<thead>
	<tr><th scope=col>n</th></tr>
	<tr><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td> 0.4012457</td></tr>
	<tr><td> 0.7259932</td></tr>
	<tr><td>-0.6223046</td></tr>
	<tr><td>-0.1461610</td></tr>
	<tr><td> 1.1621643</td></tr>
	<tr><td>-0.1080877</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>We can see that the distribution of values  appears to be normally distributed from the <code class="docutils literal notranslate"><span class="pre">histogram</span></code> plot</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># histogram plot of n</span>

<span class="n">data_norm</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">n</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">geom_histogram</span><span class="p">(</span><span class="n">binwidth</span><span class="o">=</span><span class="n">.</span><span class="m">25</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/10551c061a334a02fb439b7ccd5690a5388906d19de98140642e9f91108bcb35.png" src="../_images/10551c061a334a02fb439b7ccd5690a5388906d19de98140642e9f91108bcb35.png" />
</div>
</div>
<p>We can assess if the distribution is normally distibuted using the QQ plot. It plots the quantile-quantile correlation between the theoretical normal distribution (x-axis) and the observed values (y-axis)</p>
<p>To plot the QQ plot, we use the <code class="docutils literal notranslate"><span class="pre">geom_qq</span></code> and <code class="docutils literal notranslate"><span class="pre">geom_qq_line</span></code> functions and specify the following</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">aes</span></code> in <code class="docutils literal notranslate"><span class="pre">ggplot</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">sample</span></code>= continuous variable</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">geom_qq</span></code> plots the quantile-quantile correlation</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">color</span></code>: optional color of data points</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">geom_qq_line</span></code> plots the line that data should fall on if normally distributed</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">color</span></code>: optional color of line</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># qq qplot of n</span>

<span class="n">data_norm</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">sample</span><span class="o">=</span><span class="n">n</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">geom_qq</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">geom_qq_line</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/2f1577171d12fec139b695fc0b98fda781dc6e86592d4afaa0cc9d3ffead4b1e.png" src="../_images/2f1577171d12fec139b695fc0b98fda781dc6e86592d4afaa0cc9d3ffead4b1e.png" />
</div>
</div>
<p>We can see that most of the points fall on the line, consistent with the conclusion that the data is normally distributed</p>
<p>Let us examine the distribution of BMI in our dataset</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># histogram plot of BMI</span>

<span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">BMI</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">geom_histogram</span><span class="p">(</span><span class="n">binwidth</span><span class="o">=</span><span class="m">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning message:
“Removed 19 rows containing non-finite values (`stat_bin()`).”
</pre></div>
</div>
<img alt="../_images/ae37b91916fd34e51f7a0d04a1fc93dc0d6d8c46fd57ae70745927ebbb0a5e87.png" src="../_images/ae37b91916fd34e51f7a0d04a1fc93dc0d6d8c46fd57ae70745927ebbb0a5e87.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># qqplot of BMI</span>

<span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">sample</span><span class="o">=</span><span class="n">BMI</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">geom_qq</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">geom_qq_line</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning message:
“Removed 19 rows containing non-finite values (`stat_qq()`).”
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning message:
“Removed 19 rows containing non-finite values (`stat_qq_line()`).”
</pre></div>
</div>
<img alt="../_images/094ef2ab6d52fbc253655ad04fd3d07b2715c1b25be82eef90dc4b5255e58ec6.png" src="../_images/094ef2ab6d52fbc253655ad04fd3d07b2715c1b25be82eef90dc4b5255e58ec6.png" />
</div>
</div>
<p>It appear the values at both lower and upper tails deviate from the theoretical line, suggesting that the BMI values are not normally distributed at the tails</p>
</section>
</section>
<hr class="docutils" />
<section id="continuous-data-1-variable-with-categorical-variable-s">
<h2>4. Continuous data (1 variable) with categorical variable(s)<a class="headerlink" href="#continuous-data-1-variable-with-categorical-variable-s" title="Permalink to this heading">#</a></h2>
<section id="id2">
<h3>4.1. Histogram<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h3>
<p>We can visualize distributions of continuous data <strong>grouped by</strong> categorical variable(s) using</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">fill</span></code> mapped to a category to color subsets of the distribution</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">facet</span></code> layer to split the distribution plots</p></li>
</ul>
<p>As an example, we start with a histogram of <code class="docutils literal notranslate"><span class="pre">age</span></code> from our dataset</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">age</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">geom_histogram</span><span class="p">(</span><span class="n">binwidth</span><span class="o">=</span><span class="m">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/1e4ac851523e98909a8ff56dd596c112be9400982ddc5a6d7661b77824c70f9a.png" src="../_images/1e4ac851523e98909a8ff56dd596c112be9400982ddc5a6d7661b77824c70f9a.png" />
</div>
</div>
<p>We can specify <code class="docutils literal notranslate"><span class="pre">fill</span></code> in the mapping to show the distributions of the continuous values broken down by categories</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">aes</span></code> in <code class="docutils literal notranslate"><span class="pre">ggplot</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code>= continuous variable</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fill</span></code>= categorical variable</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">age</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="n">prevalentHyp</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">geom_histogram</span><span class="p">(</span><span class="n">binwidth</span><span class="o">=</span><span class="m">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/322987f1d4b891afd4ebea98ea941db12349ed6567a77bbe0416e8677f443af4.png" src="../_images/322987f1d4b891afd4ebea98ea941db12349ed6567a77bbe0416e8677f443af4.png" />
</div>
</div>
<p>We can also <code class="docutils literal notranslate"><span class="pre">facet</span></code> the plot to create subplots of the distribution by category</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">aes</span></code> in <code class="docutils literal notranslate"><span class="pre">ggplot</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code>= continuous variable</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fill</span></code>= categorical variable</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">facet_grid</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">row</span> <span class="pre">~</span> <span class="pre">column</span></code>: categorical variable (row or column layout)</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># facet histogram plot by prevalentHyp (column layout)</span>

<span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">age</span><span class="p">,</span><span class="n">fill</span><span class="o">=</span><span class="n">prevalentHyp</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">geom_histogram</span><span class="p">(</span><span class="n">binwidth</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">facet_grid</span><span class="p">(</span><span class="n">.</span><span class="o">~</span><span class="n">prevalentHyp</span><span class="p">)</span><span class="w"> </span><span class="c1"># column</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/479731b5f7062b614a3cf304250f56fdda3eb39725d1c260b8a850fff678c6fe.png" src="../_images/479731b5f7062b614a3cf304250f56fdda3eb39725d1c260b8a850fff678c6fe.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># facet histogram plot by prevalentHyp (row) and currentSmoker (column)</span>

<span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">age</span><span class="p">,</span><span class="n">fill</span><span class="o">=</span><span class="n">prevalentHyp</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">geom_histogram</span><span class="p">(</span><span class="n">binwidth</span><span class="o">=</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">facet_grid</span><span class="p">(</span><span class="n">prevalentHyp</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">currentSmoker</span><span class="p">)</span><span class="w"> </span><span class="c1"># row ~ column</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/24bd502a66fbd4eeaf7c193c2d930ef4738b20b2916f8e6d87b221eab6590961.png" src="../_images/24bd502a66fbd4eeaf7c193c2d930ef4738b20b2916f8e6d87b221eab6590961.png" />
</div>
</div>
</section>
<section id="id3">
<h3>4.2. Boxplot<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h3>
<p>We can visualize boxplots <strong>grouped by</strong> categorical variable(s) using</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code> mapped to the categorical variable</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">facet</span></code> layer to split by the categorical variable(s)</p></li>
</ul>
<p>We will illustrate these starting with a boxplot of <code class="docutils literal notranslate"><span class="pre">sysBP</span></code> from the dataset</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># boxplot of age with all categories specified</span>

<span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">&quot;all&quot;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">sysBP</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="c1"># x mapped to all categories</span>
<span class="w">  </span><span class="nf">geom_boxplot</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="m">0.25</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/1d9ef4108961c902b70a0e15858d9f0bfdecb19fe982a781955fc4c382cc9d48.png" src="../_images/1d9ef4108961c902b70a0e15858d9f0bfdecb19fe982a781955fc4c382cc9d48.png" />
</div>
</div>
<p>To show the different boxplots for each category, we set the <code class="docutils literal notranslate"><span class="pre">x</span></code> mapping to the <code class="docutils literal notranslate"><span class="pre">categorical</span> <span class="pre">variable</span></code> instead of <code class="docutils literal notranslate"><span class="pre">&quot;all&quot;</span></code></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">aes</span></code> in <code class="docutils literal notranslate"><span class="pre">ggplot</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code>= categorical variable</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">y</span></code>= continuous variable for boxplot</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># boxplot of sysBP grouped by sex</span>

<span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">sex</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">sysBP</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">geom_boxplot</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="m">0.25</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ada307ddbb538def34193e0bb7ba6843f59611a47b95bf842621f8599f14d90c.png" src="../_images/ada307ddbb538def34193e0bb7ba6843f59611a47b95bf842621f8599f14d90c.png" />
</div>
</div>
<p>For additional categories, we can also <code class="docutils literal notranslate"><span class="pre">facet</span></code> the boxplot</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">aes</span></code> in <code class="docutils literal notranslate"><span class="pre">ggplot</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code>= categorical variable</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">y</span></code>= continuous variable for boxplot</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">facet_grid</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">row</span> <span class="pre">~</span> <span class="pre">column</span></code>: additional categorical variable(s) (row or column layout)</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># boxplot of sysBP grouped by sex and faceted by diabetes</span>

<span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">sex</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">sysBP</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">geom_boxplot</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">facet_grid</span><span class="p">(</span><span class="n">.</span><span class="o">~</span><span class="n">diabetes</span><span class="p">)</span><span class="w"> </span><span class="c1"># facet by diabetes in column layout</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/c2a10c534428296a03abab555780870f1125328ff8674530a259fdab8121faf4.png" src="../_images/c2a10c534428296a03abab555780870f1125328ff8674530a259fdab8121faf4.png" />
</div>
</div>
</section>
</section>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="data-visualization-pt-3">
<h1>Data Visualization (Pt 3)<a class="headerlink" href="#data-visualization-pt-3" title="Permalink to this heading">#</a></h1>
<ul class="simple">
<li><p>Categorical (1 variable)</p></li>
<li><p>Categorical (&gt;1 variables)</p></li>
<li><p>Continuous (1 variable)</p></li>
<li><p>Continuous (1 variable) with categorical variable(s)</p></li>
<li><p><strong>Continuous (2 variables)</strong></p></li>
<li><p><strong>Continuous (2 variables) with categorical variable(s)</strong></p></li>
</ul>
<section id="continuous-2-variables">
<h2>5. Continuous (2 variables)<a class="headerlink" href="#continuous-2-variables" title="Permalink to this heading">#</a></h2>
<p>The relationship between 2 continuous variables can be visualized with a scatterplot</p>
<p><img alt="ggplot_point.png" src="../_images/ggplot_point.png" /></p>
<p>To plot a scatterplot, we use the <code class="docutils literal notranslate"><span class="pre">geom_point</span></code> function and specify the following</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">aes</span></code> in <code class="docutils literal notranslate"><span class="pre">ggplot</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code>= continuous variable 1</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">y</span></code>= continuous variable 2</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">geom_point</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">color</span></code>: optional color</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">size</span></code>: optional size</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">shape</span></code>: optional shape</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># scatterplot of BMI and sysBP</span>

<span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">BMI</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">sysBP</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">geom_point</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning message:
“Removed 19 rows containing missing values (`geom_point()`).”
</pre></div>
</div>
<img alt="../_images/2b0359885ca329afb02ca24a8ba354ea20a613f9de2f86f234f8f076cb340179.png" src="../_images/2b0359885ca329afb02ca24a8ba354ea20a613f9de2f86f234f8f076cb340179.png" />
</div>
</div>
<p>We can add a <code class="docutils literal notranslate"><span class="pre">geom_smooth</span></code> function to draw a linear regression line to highlight any possible linear relationship between the 2 continuous variables</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">aes</span></code> in <code class="docutils literal notranslate"><span class="pre">ggplot</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code>= continuous variable 1</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">y</span></code>= continuous variable 2</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">geom_point</span></code> to plot the x,y points</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">geom_smooth</span></code> to plot the regression line</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">method</span></code>: set to <code class="docutils literal notranslate"><span class="pre">lm</span></code> for linear line</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># scatterplot of BMI and sysBP with linear regression line</span>

<span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">BMI</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">sysBP</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">geom_smooth</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s">&quot;lm&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`geom_smooth()` using formula = &#39;y ~ x&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning message:
“Removed 19 rows containing non-finite values (`stat_smooth()`).”
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning message:
“Removed 19 rows containing missing values (`geom_point()`).”
</pre></div>
</div>
<img alt="../_images/9938b4d6985c039afd4557df18affd4216589a8b0e45c3840cc49af9b7ad7c05.png" src="../_images/9938b4d6985c039afd4557df18affd4216589a8b0e45c3840cc49af9b7ad7c05.png" />
</div>
</div>
</section>
<section id="continuous-data-2-variables-with-categorical-variable-s">
<h2>6. Continuous data (2 variables) with categorical variable(s)<a class="headerlink" href="#continuous-data-2-variables-with-categorical-variable-s" title="Permalink to this heading">#</a></h2>
<p>We can visualize scatterplots <strong>grouped by</strong> categorical variable(s) using</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">color</span></code>,<code class="docutils literal notranslate"><span class="pre">size</span></code> or <code class="docutils literal notranslate"><span class="pre">shape</span></code> mapped to a category</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">facet</span></code> layer to split the distribution plots</p></li>
</ul>
<section id="mapping-categories-to-points">
<h3>6.1. Mapping categories to points<a class="headerlink" href="#mapping-categories-to-points" title="Permalink to this heading">#</a></h3>
<p>We can use <code class="docutils literal notranslate"><span class="pre">color</span></code>, <code class="docutils literal notranslate"><span class="pre">size</span></code>, <code class="docutils literal notranslate"><span class="pre">shape</span></code> in <code class="docutils literal notranslate"><span class="pre">aes</span></code> to map a categorical variable to the scatterplot</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">aes</span></code> in <code class="docutils literal notranslate"><span class="pre">ggplot</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">color</span></code>= categorical variable</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">size</span></code>= categorical variable</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">shape</span></code>= categorical variable</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">geom_point</span></code> to plot the x,y points</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># scatterplot grouped by sex using color</span>

<span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">BMI</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">sysBP</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="o">=</span><span class="n">sex</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">geom_point</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning message:
“Removed 19 rows containing missing values (`geom_point()`).”
</pre></div>
</div>
<img alt="../_images/b819879284707aa5487fcda061b51645aefcd4a439f0b4e17ee99ad70e063cb5.png" src="../_images/b819879284707aa5487fcda061b51645aefcd4a439f0b4e17ee99ad70e063cb5.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># scatterplot grouped by sex using size</span>

<span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">BMI</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">sysBP</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="n">sex</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">geom_point</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning message:
“Using <span class=" -Color -Color-Green">size</span> for a discrete variable is not advised.”
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning message:
“Removed 19 rows containing missing values (`geom_point()`).”
</pre></div>
</div>
<img alt="../_images/e96ae05253645f4194db47cd2967f842fd35566a5d73059301dca39d5dc47554.png" src="../_images/e96ae05253645f4194db47cd2967f842fd35566a5d73059301dca39d5dc47554.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># scatterplot grouped by sex using shape</span>

<span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">BMI</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">sysBP</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="o">=</span><span class="n">sex</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">geom_point</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning message:
“Removed 19 rows containing missing values (`geom_point()`).”
</pre></div>
</div>
<img alt="../_images/780253fb6fa0327ba51f6081f6e6c057c8693e64dcd49332eb3fae11b15ef156.png" src="../_images/780253fb6fa0327ba51f6081f6e6c057c8693e64dcd49332eb3fae11b15ef156.png" />
</div>
</div>
<p>As you can see, the <code class="docutils literal notranslate"><span class="pre">color</span></code> mapping appears to be more effective in highlight the different categories in the scatterplot</p>
</section>
<section id="faceting">
<h3>6.2. Faceting<a class="headerlink" href="#faceting" title="Permalink to this heading">#</a></h3>
<p>We can also <code class="docutils literal notranslate"><span class="pre">facet</span></code> the scatterplot to create subplots by category</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">aes</span></code> in <code class="docutils literal notranslate"><span class="pre">ggplot</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code>= continuous variable 1</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">y</span></code>= continuous variable 2</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">facet_grid</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">row</span> <span class="pre">~</span> <span class="pre">column</span></code>: categorical variable(s) (row or column layout)</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># scatterplot of BMI and sysBP faceted by prevalentHyp</span>

<span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">BMI</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">sysBP</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">facet_grid</span><span class="p">(</span><span class="n">.</span><span class="o">~</span><span class="n">prevalentHyp</span><span class="p">)</span><span class="w"> </span><span class="c1"># prevalentHyp column layout</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning message:
“Removed 19 rows containing missing values (`geom_point()`).”
</pre></div>
</div>
<img alt="../_images/d4346ba9d65d49ef9126eb006292e641edb76f66a2c856c34955c6e1ce60d8b9.png" src="../_images/d4346ba9d65d49ef9126eb006292e641edb76f66a2c856c34955c6e1ce60d8b9.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># scatterplot of BMI and sysBP faceted by sex and prevalentHyp</span>

<span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">BMI</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">sysBP</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">facet_grid</span><span class="p">(</span><span class="n">sex</span><span class="o">~</span><span class="n">prevalentHyp</span><span class="p">)</span><span class="w"> </span><span class="c1"># sex (row) and prevalentHyp (column)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning message:
“Removed 19 rows containing missing values (`geom_point()`).”
</pre></div>
</div>
<img alt="../_images/ec78fd0a6a04cd8fcbbc5cace194d4ff0fb9ca554b4312b87b0e672d971967a0.png" src="../_images/ec78fd0a6a04cd8fcbbc5cace194d4ff0fb9ca554b4312b87b0e672d971967a0.png" />
</div>
</div>
</section>
</section>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="exercise-visualizing-data">
<h1>Exercise - Visualizing Data<a class="headerlink" href="#exercise-visualizing-data" title="Permalink to this heading">#</a></h1>
<p>We will use the Framingham heart study dataset</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span>

<span class="c1"># load data</span>
<span class="n">data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read_csv</span><span class="p">(</span><span class="s">&quot;https://raw.githubusercontent.com/kennethban/dataset/main/framingham.csv&quot;</span><span class="p">)</span>

<span class="c1"># renaming column &amp; changing data type of columns</span>
<span class="n">data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="w">        </span><span class="nf">rename</span><span class="p">(</span><span class="n">sex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">male</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="w">        </span><span class="nf">mutate</span><span class="p">(</span><span class="n">sex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">sex</span><span class="p">),</span>
<span class="w">               </span><span class="n">age</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.integer</span><span class="p">(</span><span class="n">age</span><span class="p">),</span>
<span class="w">               </span><span class="n">education</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">education</span><span class="p">),</span>
<span class="w">               </span><span class="n">currentSmoker</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">currentSmoker</span><span class="p">),</span>
<span class="w">               </span><span class="n">cigsPerDay</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.integer</span><span class="p">(</span><span class="n">cigsPerDay</span><span class="p">),</span>
<span class="w">               </span><span class="n">BPMeds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">BPMeds</span><span class="p">),</span>
<span class="w">               </span><span class="n">prevalentStroke</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">prevalentStroke</span><span class="p">),</span>
<span class="w">               </span><span class="n">prevalentHyp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">prevalentHyp</span><span class="p">),</span>
<span class="w">               </span><span class="n">diabetes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">diabetes</span><span class="p">),</span>
<span class="w">               </span><span class="n">totChol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.integer</span><span class="p">(</span><span class="n">totChol</span><span class="p">),</span>
<span class="w">               </span><span class="n">heartRate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.integer</span><span class="p">(</span><span class="n">heartRate</span><span class="p">),</span>
<span class="w">               </span><span class="n">TenYearCHD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">TenYearCHD</span><span class="p">)</span>
<span class="w">               </span><span class="p">)</span>

<span class="c1"># transforming any units</span>
<span class="n">data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="w">        </span><span class="nf">mutate</span><span class="p">(</span><span class="n">glucose</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">glucose</span><span class="o">/</span><span class="m">18</span><span class="p">,</span><span class="w"> </span><span class="n">digits</span><span class="o">=</span><span class="m">1</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="c1"># mg/dL to mmol/L</span>
<span class="w">        </span><span class="nf">mutate</span><span class="p">(</span><span class="n">totChol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">totChol</span><span class="o">/</span><span class="m">39</span><span class="p">,</span><span class="w"> </span><span class="n">digits</span><span class="o">=</span><span class="m">1</span><span class="p">))</span><span class="w">     </span><span class="c1"># mg/dL to mmol/L</span>

<span class="nf">head</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">Rows: </span><span class=" -Color -Color-Blue">4240</span> <span class=" -Color -Color-Bold">Columns: </span><span class=" -Color -Color-Blue">16</span>
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">──</span> <span class=" -Color -Color-Bold">Column specification</span> <span class=" -Color -Color-Cyan">─────────────────────────────────────────────────────────────</span>
<span class=" -Color -Color-Bold">Delimiter:</span> &quot;,&quot;
<span class=" -Color -Color-Green">dbl</span> (16): male, age, education, currentSmoker, cigsPerDay, BPMeds, prevalent...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Cyan">ℹ</span> Use `spec()` to retrieve the full column specification for this data.
<span class=" -Color -Color-Cyan">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.
</pre></div>
</div>
<div class="output text_html"><table class="dataframe">
<caption>A tibble: 6 × 16</caption>
<thead>
	<tr><th scope=col>sex</th><th scope=col>age</th><th scope=col>education</th><th scope=col>currentSmoker</th><th scope=col>cigsPerDay</th><th scope=col>BPMeds</th><th scope=col>prevalentStroke</th><th scope=col>prevalentHyp</th><th scope=col>diabetes</th><th scope=col>totChol</th><th scope=col>sysBP</th><th scope=col>diaBP</th><th scope=col>BMI</th><th scope=col>heartRate</th><th scope=col>glucose</th><th scope=col>TenYearCHD</th></tr>
	<tr><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;fct&gt;</th></tr>
</thead>
<tbody>
	<tr><td>1</td><td>39</td><td>4</td><td>0</td><td> 0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>5.0</td><td>106.0</td><td> 70</td><td>26.97</td><td>80</td><td>4.3</td><td>0</td></tr>
	<tr><td>0</td><td>46</td><td>2</td><td>0</td><td> 0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>6.4</td><td>121.0</td><td> 81</td><td>28.73</td><td>95</td><td>4.2</td><td>0</td></tr>
	<tr><td>1</td><td>48</td><td>1</td><td>1</td><td>20</td><td>0</td><td>0</td><td>0</td><td>0</td><td>6.3</td><td>127.5</td><td> 80</td><td>25.34</td><td>75</td><td>3.9</td><td>0</td></tr>
	<tr><td>0</td><td>61</td><td>3</td><td>1</td><td>30</td><td>0</td><td>0</td><td>1</td><td>0</td><td>5.8</td><td>150.0</td><td> 95</td><td>28.58</td><td>65</td><td>5.7</td><td>1</td></tr>
	<tr><td>0</td><td>46</td><td>3</td><td>1</td><td>23</td><td>0</td><td>0</td><td>0</td><td>0</td><td>7.3</td><td>130.0</td><td> 84</td><td>23.10</td><td>85</td><td>4.7</td><td>0</td></tr>
	<tr><td>0</td><td>43</td><td>2</td><td>0</td><td> 0</td><td>0</td><td>0</td><td>1</td><td>0</td><td>5.8</td><td>180.0</td><td>110</td><td>30.30</td><td>77</td><td>5.5</td><td>0</td></tr>
</tbody>
</table>
</div></div>
</div>
<section id="part-1">
<h2>Part 1<a class="headerlink" href="#part-1" title="Permalink to this heading">#</a></h2>
<p>Plot a graph to compare the different proportions of patients with <code class="docutils literal notranslate"><span class="pre">TenYearCHD</span></code> among males and females</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># start here</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># solution</span>

<span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">TenYearCHD</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="n">sex</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_bar</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="s">&quot;fill&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/52384d2194900bcaaee801e2e4f5e89c72b65766925d3081ac17d2f0f3f30d49.png" src="../_images/52384d2194900bcaaee801e2e4f5e89c72b65766925d3081ac17d2f0f3f30d49.png" />
</div>
</details>
</div>
</section>
<section id="part-2">
<h2>Part 2<a class="headerlink" href="#part-2" title="Permalink to this heading">#</a></h2>
<p>Plot a graph to show the distribution of ages in patients with and without chronic heart disease using <code class="docutils literal notranslate"><span class="pre">TenYearCHD</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># start here</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># solution</span>

<span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">age</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="n">TenYearCHD</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_histogram</span><span class="p">(</span><span class="n">binwidth</span><span class="o">=</span><span class="m">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d87c1868101964e98fec5efe4ea8b8550826fa27a3d66c2da6c29cf73f22218d.png" src="../_images/d87c1868101964e98fec5efe4ea8b8550826fa27a3d66c2da6c29cf73f22218d.png" />
</div>
</details>
</div>
</section>
<section id="part-3">
<h2>Part 3<a class="headerlink" href="#part-3" title="Permalink to this heading">#</a></h2>
<p>Evaluate if the distribution of the systolic BP is likely to be normal</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># start here</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># solution</span>

<span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">sample</span><span class="o">=</span><span class="n">sysBP</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">geom_qq</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_qq_line</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/97e29c97a7aa8e785c26f11c94691b03dbe22ff23229b0a6b8df820484cebf1a.png" src="../_images/97e29c97a7aa8e785c26f11c94691b03dbe22ff23229b0a6b8df820484cebf1a.png" />
</div>
</details>
</div>
</section>
<section id="part-4">
<h2>Part 4<a class="headerlink" href="#part-4" title="Permalink to this heading">#</a></h2>
<p>Plot a boxplot to compare the distribution of total cholesterol between patients with and without chronic heart disease using <code class="docutils literal notranslate"><span class="pre">TenYearCHD</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># start here</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># solution</span>

<span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">TenYearCHD</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">totChol</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_boxplot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning message:
“Removed 50 rows containing non-finite values (`stat_boxplot()`).”
</pre></div>
</div>
<img alt="../_images/31d041c9d408d738b6e71a6f5ba1f14a834a11af44a79fae4c3a4fcbb8caf8a8.png" src="../_images/31d041c9d408d738b6e71a6f5ba1f14a834a11af44a79fae4c3a4fcbb8caf8a8.png" />
</div>
</details>
</div>
</section>
<section id="part-5">
<h2>Part 5<a class="headerlink" href="#part-5" title="Permalink to this heading">#</a></h2>
<p>Plot a graph to examine the relationship between BMI and systolic BP, then compare this relationship among male and female patients using side-by-side plots by adding a linear regression line</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># start here for first section</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># solution</span>

<span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">BMI</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">sysBP</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_point</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning message:
“Removed 19 rows containing missing values (`geom_point()`).”
</pre></div>
</div>
<img alt="../_images/2b0359885ca329afb02ca24a8ba354ea20a613f9de2f86f234f8f076cb340179.png" src="../_images/2b0359885ca329afb02ca24a8ba354ea20a613f9de2f86f234f8f076cb340179.png" />
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># start here for second section</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># solution</span>

<span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">BMI</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">sysBP</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_smooth</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s">&quot;lm&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">facet_grid</span><span class="p">(</span><span class="n">.</span><span class="o">~</span><span class="n">sex</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`geom_smooth()` using formula = &#39;y ~ x&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning message:
“Removed 19 rows containing non-finite values (`stat_smooth()`).”
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning message:
“Removed 19 rows containing missing values (`geom_point()`).”
</pre></div>
</div>
<img alt="../_images/911256412b9037cfa81abf31faf4a868e9dcf0b73a08d11e8a4fff3776db3e93.png" src="../_images/911256412b9037cfa81abf31faf4a868e9dcf0b73a08d11e8a4fff3776db3e93.png" />
</div>
</details>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "r"
        },
        kernelOptions: {
            name: "ir",
            path: "./02-intro-to-tidyverse"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ir'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="07-1-plotting.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Visualizing Data - Overview</p>
      </div>
    </a>
    <a class="right-next"
       href="07-3-plotting.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Visualizing Data - Extensions</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Visualizing Data - Plots</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-preparation">Data preparation</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#data-visualization-pt-1">Data Visualization (Pt 1)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#categorical-data-1-variable">1. Categorical data (1 variable)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#barchart">1.1. Barchart</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacked-barchart-1-variable">1.2. Stacked barchart (1 variable)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacked-proportional-barchart-1-variable">1.3. Stacked proportional barchart (1 variable)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#categorical-data-2-variables">2. Categorical data (2 variables)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacked-barchart">2.1. Stacked barchart</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#grouped-barchart">2.2. Grouped barchart</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stacked-proportional-barchart">2.3. Stacked proportional barchart</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#categorical-data-2-variables-using-facet-layer">Categorical data (2 variables) using <code class="docutils literal notranslate"><span class="pre">facet</span></code> layer</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">2. Categorical data (&gt;2 variables)</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#data-visualization-pt-2">Data Visualization (Pt 2)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#continuous-data-1-variable">3. Continuous data (1 variable)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#histogram">3.1. Histogram</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#density-plot">3.2. Density plot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#boxplot">3.3. Boxplot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#violin-plot">3.4. Violin plot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#quantile-quantile-qq-plot">3.5. Quantile-quantile (QQ) plot</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#continuous-data-1-variable-with-categorical-variable-s">4. Continuous data (1 variable) with categorical variable(s)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">4.1. Histogram</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">4.2. Boxplot</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#data-visualization-pt-3">Data Visualization (Pt 3)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#continuous-2-variables">5. Continuous (2 variables)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#continuous-data-2-variables-with-categorical-variable-s">6. Continuous data (2 variables) with categorical variable(s)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mapping-categories-to-points">6.1. Mapping categories to points</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#faceting">6.2. Faceting</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-visualizing-data">Exercise - Visualizing Data</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-1">Part 1</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-2">Part 2</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-3">Part 3</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-4">Part 4</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#part-5">Part 5</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Kenneth Ban, NUS Medicine
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022-23.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>